{
  "hash": "bf9e5f528999cd510d7d5ae636cb5ebb",
  "result": {
    "markdown": "---\ntitle: \"Simulating 2018 NCAA March Madness Tournament Performance in R\"\nauthor: \"Nick Ray, David Hoagey, Linh Lazarus, Ekarin Pongpipat, & Matthew J. Kmiecik\"\ndate: \"20 March 2018\"\ndescription: \"A bunch of grad students compete to design the best March Madness algorithm.\"\nimage: \"./thumbnail.png\"\ncategories:\n  - Academic\n  - R\n  - March Madness\nformat:\n  html:\n    toc: true\n    toc-depth: 2\n    toc-location: left\n    smooth-scroll: true\n---\n\n\n\n\n<br >\n\nIt's that time of the year again--**MARCH MADNESS**.\n\nA few of us graduate students decided it would be fun to simulate this year's NCAA Men's National Championship tournament using R. When we all met to discuss our method to simuluate tournament performance, we quickly realized that each of us had a different method in mind. These methods differed in not only how we determined probability of win via seed, but also the techniques and packages implemented within R. Below showcases 3 different methods we used, each with different results. The methods are arranged in order of increasing use of historical data.\n\n# Matt's Method\n\nThe packages needed for this method:\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nlibrary(tidyverse); library(repmis); library(httr)\n```\n:::\n\n\n## Simulation\n\nThis method (that Nick actually invented) relies on the seed of each team in the tournament. The idea is to assign a range of numbers to each seed with the ranges of lower seeds (e.g., #1, #2, #3, ...) containing greater numbers than the ranges of higher seeds (e.g., ..., #14, #15, #16). Just like this:\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table table-striped table-hover table-responsive\" style=\"margin-left: auto; margin-right: auto;\">\n <thead>\n  <tr>\n   <th style=\"text-align:right;\"> Seed </th>\n   <th style=\"text-align:right;\"> Lower.Bound </th>\n   <th style=\"text-align:right;\"> Upper.Bound </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 160 </td>\n   <td style=\"text-align:right;\"> 320 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 2 </td>\n   <td style=\"text-align:right;\"> 150 </td>\n   <td style=\"text-align:right;\"> 310 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 3 </td>\n   <td style=\"text-align:right;\"> 140 </td>\n   <td style=\"text-align:right;\"> 300 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 4 </td>\n   <td style=\"text-align:right;\"> 130 </td>\n   <td style=\"text-align:right;\"> 290 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 5 </td>\n   <td style=\"text-align:right;\"> 120 </td>\n   <td style=\"text-align:right;\"> 280 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 6 </td>\n   <td style=\"text-align:right;\"> 110 </td>\n   <td style=\"text-align:right;\"> 270 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 7 </td>\n   <td style=\"text-align:right;\"> 100 </td>\n   <td style=\"text-align:right;\"> 260 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 8 </td>\n   <td style=\"text-align:right;\"> 90 </td>\n   <td style=\"text-align:right;\"> 250 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 9 </td>\n   <td style=\"text-align:right;\"> 80 </td>\n   <td style=\"text-align:right;\"> 240 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 10 </td>\n   <td style=\"text-align:right;\"> 70 </td>\n   <td style=\"text-align:right;\"> 230 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 11 </td>\n   <td style=\"text-align:right;\"> 60 </td>\n   <td style=\"text-align:right;\"> 220 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 12 </td>\n   <td style=\"text-align:right;\"> 50 </td>\n   <td style=\"text-align:right;\"> 210 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 13 </td>\n   <td style=\"text-align:right;\"> 40 </td>\n   <td style=\"text-align:right;\"> 200 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 14 </td>\n   <td style=\"text-align:right;\"> 30 </td>\n   <td style=\"text-align:right;\"> 190 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 15 </td>\n   <td style=\"text-align:right;\"> 20 </td>\n   <td style=\"text-align:right;\"> 180 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 16 </td>\n   <td style=\"text-align:right;\"> 10 </td>\n   <td style=\"text-align:right;\"> 170 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\nThen, randomly sample from each team's range and assign the win to the higher number (for each match-up). This is a crude method that will roughly correspond to seed. In other words, each seed has a higher probability of winning over each subsequent seed; however, it is theoretically possible, although very unlikely, for a 16^th^ seed to win the tournament. A simulation given purely historical data would not be able to account for this because a 16^th^ seed has never made it past the first round prior to the 2018 tournament.\n\nBelow is the code I used to run the simulation. I tried to avoid for loops as much as possible and learn the `map()` functions in the [purrr](https://github.com/tidyverse/purrr) package. The code is not as efficient as I would have liked it to be, but it gets the job done and allows for a variety of plots.\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n# Sets the regions\nregions <- c('South', 'East', 'West', 'Midwest')\n\n# Import the team names and their seeds from 2018\n# These data are being pulled from this website's Github repo\nlink <- 'https://raw.githubusercontent.com/mkmiecik14/mkmiecik14.github.io/master/data/ncaa-2018-teams-updated.csv'\n\n# from https://stackoverflow.com/questions/60714074/download-csv-file-from-github-using-httr-get-request\ndata <- GET(link)\nncaa.2018 <- \n  read_csv(content(data, \"raw\")) %>% \n  rename(region = Region, team = Team1, seed = Seed)\n\n# Initializations\niters <- 1000\nresults <- probTableHolder <- vector('list', length = iters)\n\n# Sets seed for reprodicible results\nset.seed(18)\n```\n:::\n\n\nThe simulation was then ran 1000 times:\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nfor(i in 1:iters) {\n\n  # Creates whole tournament probability set\n  probTableHolder[[i]] <- probTable <- regions %>% \n    map_df(~tibble(seed = c(1:16),\n                   lowNum = seq(160, 10, -10),\n                   highNum = seq(320, 170, -10)) %>%\n             group_by(seed) %>% \n             mutate(result = sample(lowNum:highNum, 1)) %>%\n             ungroup()) %>%\n    mutate(region = rep(regions, each = 16)) %>%\n    inner_join(ncaa.2018, by = c('seed', 'region'))\n  \n  # Round 1\n  r1 <- regions %>%\n    map_df(~tibble(match.up = 1:8, t1.seed = 1:8, t2.seed = 16:9) %>%\n             mutate(t1.res =  probTable$result[1:8],\n                    t2.res = probTable$result[16:9],\n                    seed = if_else(t1.res > t2.res, t1.seed, t2.seed))) %>%\n             mutate(region = rep(regions, each = 8)) %>%\n             inner_join(probTable, by = c('seed', 'region'))\n    \n  # Round 1 results\n  r1.res <- r1 %>% select(match.up, region, team, seed, result)\n  \n  # Round 2\n  r2 <- regions %>%\n    map_df(~tibble(r2.match.up = 1:4,\n                r2.match.up.1 = 1:4,\n                r2.match.up.2 = as.integer(seq(8, 5, -1)),\n                region = .) %>%\n          left_join(r1.res, \n                    by = c('r2.match.up.1' = 'match.up', \n                           'region' = 'region')) %>%\n          rename(t1.team = team, t1.seed = seed, t1.res = result) %>%\n          left_join(r1.res,\n                    by = c('r2.match.up.2' = 'match.up', \n                           'region' = 'region')) %>%\n          rename(t2.team = team, t2.seed = seed, t2.res = result) %>%\n          mutate(seed = if_else(t1.res > t2.res, t1.seed, t2.seed))) %>%\n    inner_join(probTable, by = c('region', 'seed'))\n  \n  # Round 2 results\n  r2.res <- r2 %>% select(r2.match.up, region, team, seed, result)\n  \n  # Round 3\n  r3 <- regions %>%\n    map_df(~tibble(r3.match.up = 1:2, \n                r3.match.up.1 = 1:2, \n                r3.match.up.2 = 4:3,\n                region = .) %>%\n          left_join(r2.res, \n                    by = c('r3.match.up.1' = 'r2.match.up', \n                           'region' = 'region')) %>%\n          rename(t1.team = team, t1.seed = seed, t1.res = result) %>%\n          left_join(r2.res,\n                    by = c('r3.match.up.2' = 'r2.match.up', \n                           'region' = 'region')) %>%\n          rename(t2.team = team, t2.seed = seed, t2.res = result) %>%\n          mutate(seed = if_else(t1.res > t2.res, t1.seed, t2.seed))) %>%\n    inner_join(probTable,  by = c('region', 'seed'))\n  \n  # Round 3 results\n  r3.res <- r3 %>% select(r3.match.up, region, team, seed, result)\n  \n  # Round 4\n  r4 <- regions %>%\n    map_df(~tibble(r4.match.up = 1, \n                   r4.match.up.1 = 1, \n                   r4.match.up.2 = 2,\n                   region = .) %>%\n             inner_join(r3.res, \n                        by = c('r4.match.up.1' = 'r3.match.up', \n                               'region' = 'region')) %>%\n             rename(t1.team = team, t1.seed = seed, t1.res = result) %>%\n             inner_join(r3.res, by = c('r4.match.up.2' = 'r3.match.up',\n                                       'region' = 'region')) %>%\n             rename(t2.team = team, t2.seed = seed, t2.res = result) %>%\n             mutate(seed = if_else(t1.res > t2.res, t1.seed, t2.seed))) %>%\n    inner_join(probTable,  by = c('region', 'seed'))\n  \n  # Round 4 results\n  r4.res <- r4 %>% select(r4.match.up, region, team, seed, result)\n  \n  # Semifinal\n  semi.final <- tibble(t1.region = c('South', 'East'),\n                       t2.region = c('West', 'Midwest')) %>%\n    left_join(r4.res, by = c('t1.region' = 'region')) %>%\n    rename(t1.team = team, t1.seed = seed, t1.res = result) %>%\n    left_join(r4.res, by = c('t2.region' = 'region')) %>%\n    rename(t2.team = team, t2.seed = seed, t2.res = result) %>%\n    mutate(team = if_else(t1.res > t2.res, t1.team, t2.team)) %>%\n    inner_join(probTable, by = 'team')\n  \n  # Semifinal results\n  semi.final.res <- semi.final %>% select(region, team, seed, result)\n  \n  # Final\n  final <- tibble(t1.region = semi.final.res$team[1],\n                  t2.region = semi.final.res$team[2],\n                  t1.team = semi.final.res$team[1],\n                  t2.team = semi.final.res$team[2],\n                  t1.seed = semi.final.res$team[1],\n                  t2.seed = semi.final.res$team[2],\n                  t1.res = semi.final.res$result[1],\n                  t2.res = semi.final.res$result[2]) %>%\n    mutate(team = if_else(t1.res > t2.res, t1.team, t2.team)) %>%\n    inner_join(probTable, by = 'team')\n  \n  final.res <- final %>% select(region, team, seed, result)\n  \n  results[[i]] <- this.result <- bind_rows(r1.res, r2.res, r3.res, r4.res,\n                                           semi.final.res, final.res, \n                                           .id = 'round')\n  \n  #print(i) # Uncomment to see progress\n}\n```\n:::\n\n::: {.cell layout-align=\"center\"}\n\n:::\n\n\n## Data Viz\n\nThe results of this simulation were saved out and can be imported from this website's [Github data repository](https://github.com/mkmiecik14/mkmiecik14.github.io/tree/master/data) like this:\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n# Loading probability tables from github\nprobTableLink <- 'https://github.com/mkmiecik14/mkmiecik14.github.io/blob/master/data/probTableHolder-updated.RData?raw=true'\nsource_data(probTableLink)\n\n# Loading simulation results from github\nresultsLink <- 'https://github.com/mkmiecik14/mkmiecik14.github.io/blob/master/data/results-updated.RData?raw=true'\nsource_data(resultsLink)\n```\n:::\n\n\nFirst, let's ensure that the probability table results worked across simulations and regions:\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n# Converts into a dataframe\nprobTable.long <- probTableHolder %>% map_df(bind_rows, .id = 'iter')\n\n# Calculates summary stats\nprobTable.sum <- probTable.long %>% \n  group_by(seed, region) %>%\n  summarize(m = mean(result),\n            sd = sd(result),\n            n = n(),\n            sem = sd/sqrt(n))\n\n# Probability table plot\nggplot(probTable.long, aes(factor(seed), result, color = region)) +\n  geom_point(position = 'jitter', alpha = 1/3, shape = 1) +\n  geom_pointrange(\n    data = probTable.sum, \n    aes(factor(seed), m, color = region, ymin = m - sd, ymax = m + sd),\n    color = 'black'\n      ) +\n  geom_line(\n    data = probTable.sum, \n    aes(factor(seed), m, group = 1, color = region), \n    color = 'black', alpha = 1/2\n    ) +\n  scale_color_brewer(palette = 'Set2', name = 'Region') +\n  labs(x = 'Seed', y = 'Randomly Chosen Value', caption = 'SD Error Bars') +\n  theme_minimal() +\n  facet_wrap(~region)\n```\n\n::: {.cell-output-display}\n![](post-Simulating-2018-NCAA-March-Madness-Tournament-Performance-in-R_files/figure-html/unnamed-chunk-7-1.png){fig-align='center' width=672}\n:::\n:::\n\n\nThis above visualization depicts the potential ranges from which each seed can draw an arbitrary number. This drawing occurs at the beginning of each simulation iteration and determines each team's tournament fate. Higher seeds have an advantage of a higher possible range, but this overlap gradually decreases with increases in seed.\n\nNow let's examine the results of the simulations. As a check, better seeds should win with more frequency each round than worse seeds:\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n# Converts to long dataframe\nresults.long <- results %>% map_df(bind_rows, .id = 'iter')\n\n# Win histogram\nggplot(results.long, aes(as.factor(seed), fill = region)) +\n  geom_histogram(stat = 'count') +\n  facet_grid(round~region) +\n  scale_x_discrete(breaks = seq(1, 16, 3)) +\n  labs(x = 'Seed', y = 'Win Frequency', title = 'Number of Wins Per Round') +\n  scale_fill_brewer(palette = 'Set2', name = 'Region') +\n  theme_minimal()\n```\n\n::: {.cell-output-display}\n![](post-Simulating-2018-NCAA-March-Madness-Tournament-Performance-in-R_files/figure-html/unnamed-chunk-8-1.png){fig-align='center' width=672}\n:::\n:::\n\n\nThe above plot confirms this; higher seeds win more often than lower seeds for each round.\n\nNow for fun, let's see which teams won the tournament most often.\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n# Round 6 summary information\nresults.long.sum1 <- results.long %>% \n  filter(round == '6') %>% \n  group_by(team, region) %>%\n  summarise(n = n(), seed = unique(seed))\n\n# Winner plot\nggplot(results.long.sum1, aes(reorder(team, -1*n), n, fill = region)) +\n  geom_bar(stat = 'identity') +\n  scale_fill_brewer(palette = 'Set2', name = 'Region') +\n  labs(\n    x = 'Team', y = 'NCAA Tournament Wins', \n    caption = paste('Simulation iterations:', iters)\n    ) +\n  geom_text(aes(label = seed), nudge_y = 4, color = 'grey') + \n  theme_minimal() +\n  theme(axis.text.x = element_text(angle = 45, hjust = 1))\n```\n\n::: {.cell-output-display}\n![](post-Simulating-2018-NCAA-March-Madness-Tournament-Performance-in-R_files/figure-html/unnamed-chunk-9-1.png){fig-align='center' width=672}\n:::\n:::\n\n\nThere are some clear, but expected, patterns that emerge given a simulation based solely on seed. First, #1 seeds tend to win more often than lower seeds. Second, win frequency tracks well with seed, but in a diminishing step-wise way. The margin is closer between #3 vs #4 seeds, than #2 vs #3 seeds, than #1 vs #2. Perhaps this has to do with the NCAA men's tournament not re-seeding teams on a round-by-round basis (see this [video](https://www.youtube.com/watch?v=4a1TUszkMfI) by Jon Bois).\n\nHowever, this method did allow for some upsets. As we can see, three #6 seeds won the tournament (TCU, Houston, Miami)!\n\nSo, does this analysis inform my bracket this year at all? Sort of, but I'd rather just have R do it for me.\n\nI'll just have the computer pick a random iteration that occured and I'll use that to fill out my bracket:\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n# Random selection from the set of simulation iterations\n# note: seed was set earlier in script\nmyPick <- sample(1:iters, 1)\n\n# Matt's bracket from a random simulation iteration\nmattsBracket <- results.long %>% \n  filter(iter == myPick) %>% \n  select(round, region, team, seed) %>%\n  rename(winner = team)\n```\n:::\n\n\nSo here's what the computer drew for me (winners of each round):\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n`````{=html}\n<div style=\"border: 1px solid #ddd; padding: 0px; overflow-y: scroll; height:400px; \"><table class=\"table table-striped table-hover table-responsive\" style=\"margin-left: auto; margin-right: auto;\">\n <thead>\n  <tr>\n   <th style=\"text-align:left;position: sticky; top:0; background-color: #FFFFFF;\"> round </th>\n   <th style=\"text-align:left;position: sticky; top:0; background-color: #FFFFFF;\"> region </th>\n   <th style=\"text-align:left;position: sticky; top:0; background-color: #FFFFFF;\"> winner </th>\n   <th style=\"text-align:right;position: sticky; top:0; background-color: #FFFFFF;\"> seed </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> 1 </td>\n   <td style=\"text-align:left;\"> South </td>\n   <td style=\"text-align:left;\"> Virginia </td>\n   <td style=\"text-align:right;\"> 1 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 1 </td>\n   <td style=\"text-align:left;\"> South </td>\n   <td style=\"text-align:left;\"> Cincinnati </td>\n   <td style=\"text-align:right;\"> 2 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 1 </td>\n   <td style=\"text-align:left;\"> South </td>\n   <td style=\"text-align:left;\"> Tennessee </td>\n   <td style=\"text-align:right;\"> 3 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 1 </td>\n   <td style=\"text-align:left;\"> South </td>\n   <td style=\"text-align:left;\"> Arizona </td>\n   <td style=\"text-align:right;\"> 4 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 1 </td>\n   <td style=\"text-align:left;\"> South </td>\n   <td style=\"text-align:left;\"> Kentucky </td>\n   <td style=\"text-align:right;\"> 5 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 1 </td>\n   <td style=\"text-align:left;\"> South </td>\n   <td style=\"text-align:left;\"> Loyola Chicago </td>\n   <td style=\"text-align:right;\"> 11 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 1 </td>\n   <td style=\"text-align:left;\"> South </td>\n   <td style=\"text-align:left;\"> Nevada </td>\n   <td style=\"text-align:right;\"> 7 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 1 </td>\n   <td style=\"text-align:left;\"> South </td>\n   <td style=\"text-align:left;\"> Creighton </td>\n   <td style=\"text-align:right;\"> 8 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 1 </td>\n   <td style=\"text-align:left;\"> East </td>\n   <td style=\"text-align:left;\"> Villanova </td>\n   <td style=\"text-align:right;\"> 1 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 1 </td>\n   <td style=\"text-align:left;\"> East </td>\n   <td style=\"text-align:left;\"> Purdue </td>\n   <td style=\"text-align:right;\"> 2 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 1 </td>\n   <td style=\"text-align:left;\"> East </td>\n   <td style=\"text-align:left;\"> Texas Tech </td>\n   <td style=\"text-align:right;\"> 3 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 1 </td>\n   <td style=\"text-align:left;\"> East </td>\n   <td style=\"text-align:left;\"> Wichita State </td>\n   <td style=\"text-align:right;\"> 4 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 1 </td>\n   <td style=\"text-align:left;\"> East </td>\n   <td style=\"text-align:left;\"> West Virginia </td>\n   <td style=\"text-align:right;\"> 5 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 1 </td>\n   <td style=\"text-align:left;\"> East </td>\n   <td style=\"text-align:left;\"> St. Bona </td>\n   <td style=\"text-align:right;\"> 11 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 1 </td>\n   <td style=\"text-align:left;\"> East </td>\n   <td style=\"text-align:left;\"> Arkansas </td>\n   <td style=\"text-align:right;\"> 7 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 1 </td>\n   <td style=\"text-align:left;\"> East </td>\n   <td style=\"text-align:left;\"> Virginia Tech </td>\n   <td style=\"text-align:right;\"> 8 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 1 </td>\n   <td style=\"text-align:left;\"> West </td>\n   <td style=\"text-align:left;\"> Xavier </td>\n   <td style=\"text-align:right;\"> 1 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 1 </td>\n   <td style=\"text-align:left;\"> West </td>\n   <td style=\"text-align:left;\"> North Carolina </td>\n   <td style=\"text-align:right;\"> 2 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 1 </td>\n   <td style=\"text-align:left;\"> West </td>\n   <td style=\"text-align:left;\"> Michigan </td>\n   <td style=\"text-align:right;\"> 3 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 1 </td>\n   <td style=\"text-align:left;\"> West </td>\n   <td style=\"text-align:left;\"> Gonzaga </td>\n   <td style=\"text-align:right;\"> 4 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 1 </td>\n   <td style=\"text-align:left;\"> West </td>\n   <td style=\"text-align:left;\"> Ohio State </td>\n   <td style=\"text-align:right;\"> 5 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 1 </td>\n   <td style=\"text-align:left;\"> West </td>\n   <td style=\"text-align:left;\"> San Diego State </td>\n   <td style=\"text-align:right;\"> 11 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 1 </td>\n   <td style=\"text-align:left;\"> West </td>\n   <td style=\"text-align:left;\"> Texas A&amp;M </td>\n   <td style=\"text-align:right;\"> 7 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 1 </td>\n   <td style=\"text-align:left;\"> West </td>\n   <td style=\"text-align:left;\"> Missouri </td>\n   <td style=\"text-align:right;\"> 8 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 1 </td>\n   <td style=\"text-align:left;\"> Midwest </td>\n   <td style=\"text-align:left;\"> Kansas </td>\n   <td style=\"text-align:right;\"> 1 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 1 </td>\n   <td style=\"text-align:left;\"> Midwest </td>\n   <td style=\"text-align:left;\"> Duke </td>\n   <td style=\"text-align:right;\"> 2 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 1 </td>\n   <td style=\"text-align:left;\"> Midwest </td>\n   <td style=\"text-align:left;\"> Michigan State </td>\n   <td style=\"text-align:right;\"> 3 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 1 </td>\n   <td style=\"text-align:left;\"> Midwest </td>\n   <td style=\"text-align:left;\"> Auburn </td>\n   <td style=\"text-align:right;\"> 4 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 1 </td>\n   <td style=\"text-align:left;\"> Midwest </td>\n   <td style=\"text-align:left;\"> Clemson </td>\n   <td style=\"text-align:right;\"> 5 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 1 </td>\n   <td style=\"text-align:left;\"> Midwest </td>\n   <td style=\"text-align:left;\"> Syracuse </td>\n   <td style=\"text-align:right;\"> 11 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 1 </td>\n   <td style=\"text-align:left;\"> Midwest </td>\n   <td style=\"text-align:left;\"> Rhode Island </td>\n   <td style=\"text-align:right;\"> 7 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 1 </td>\n   <td style=\"text-align:left;\"> Midwest </td>\n   <td style=\"text-align:left;\"> Seton Hall </td>\n   <td style=\"text-align:right;\"> 8 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 2 </td>\n   <td style=\"text-align:left;\"> South </td>\n   <td style=\"text-align:left;\"> Virginia </td>\n   <td style=\"text-align:right;\"> 1 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 2 </td>\n   <td style=\"text-align:left;\"> South </td>\n   <td style=\"text-align:left;\"> Nevada </td>\n   <td style=\"text-align:right;\"> 7 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 2 </td>\n   <td style=\"text-align:left;\"> South </td>\n   <td style=\"text-align:left;\"> Tennessee </td>\n   <td style=\"text-align:right;\"> 3 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 2 </td>\n   <td style=\"text-align:left;\"> South </td>\n   <td style=\"text-align:left;\"> Arizona </td>\n   <td style=\"text-align:right;\"> 4 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 2 </td>\n   <td style=\"text-align:left;\"> East </td>\n   <td style=\"text-align:left;\"> Villanova </td>\n   <td style=\"text-align:right;\"> 1 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 2 </td>\n   <td style=\"text-align:left;\"> East </td>\n   <td style=\"text-align:left;\"> Purdue </td>\n   <td style=\"text-align:right;\"> 2 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 2 </td>\n   <td style=\"text-align:left;\"> East </td>\n   <td style=\"text-align:left;\"> St. Bona </td>\n   <td style=\"text-align:right;\"> 11 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 2 </td>\n   <td style=\"text-align:left;\"> East </td>\n   <td style=\"text-align:left;\"> Wichita State </td>\n   <td style=\"text-align:right;\"> 4 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 2 </td>\n   <td style=\"text-align:left;\"> West </td>\n   <td style=\"text-align:left;\"> Xavier </td>\n   <td style=\"text-align:right;\"> 1 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 2 </td>\n   <td style=\"text-align:left;\"> West </td>\n   <td style=\"text-align:left;\"> North Carolina </td>\n   <td style=\"text-align:right;\"> 2 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 2 </td>\n   <td style=\"text-align:left;\"> West </td>\n   <td style=\"text-align:left;\"> Michigan </td>\n   <td style=\"text-align:right;\"> 3 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 2 </td>\n   <td style=\"text-align:left;\"> West </td>\n   <td style=\"text-align:left;\"> Gonzaga </td>\n   <td style=\"text-align:right;\"> 4 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 2 </td>\n   <td style=\"text-align:left;\"> Midwest </td>\n   <td style=\"text-align:left;\"> Seton Hall </td>\n   <td style=\"text-align:right;\"> 8 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 2 </td>\n   <td style=\"text-align:left;\"> Midwest </td>\n   <td style=\"text-align:left;\"> Duke </td>\n   <td style=\"text-align:right;\"> 2 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 2 </td>\n   <td style=\"text-align:left;\"> Midwest </td>\n   <td style=\"text-align:left;\"> Michigan State </td>\n   <td style=\"text-align:right;\"> 3 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 2 </td>\n   <td style=\"text-align:left;\"> Midwest </td>\n   <td style=\"text-align:left;\"> Clemson </td>\n   <td style=\"text-align:right;\"> 5 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 3 </td>\n   <td style=\"text-align:left;\"> South </td>\n   <td style=\"text-align:left;\"> Arizona </td>\n   <td style=\"text-align:right;\"> 4 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 3 </td>\n   <td style=\"text-align:left;\"> South </td>\n   <td style=\"text-align:left;\"> Tennessee </td>\n   <td style=\"text-align:right;\"> 3 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 3 </td>\n   <td style=\"text-align:left;\"> East </td>\n   <td style=\"text-align:left;\"> Villanova </td>\n   <td style=\"text-align:right;\"> 1 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 3 </td>\n   <td style=\"text-align:left;\"> East </td>\n   <td style=\"text-align:left;\"> Purdue </td>\n   <td style=\"text-align:right;\"> 2 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 3 </td>\n   <td style=\"text-align:left;\"> West </td>\n   <td style=\"text-align:left;\"> Xavier </td>\n   <td style=\"text-align:right;\"> 1 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 3 </td>\n   <td style=\"text-align:left;\"> West </td>\n   <td style=\"text-align:left;\"> North Carolina </td>\n   <td style=\"text-align:right;\"> 2 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 3 </td>\n   <td style=\"text-align:left;\"> Midwest </td>\n   <td style=\"text-align:left;\"> Clemson </td>\n   <td style=\"text-align:right;\"> 5 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 3 </td>\n   <td style=\"text-align:left;\"> Midwest </td>\n   <td style=\"text-align:left;\"> Duke </td>\n   <td style=\"text-align:right;\"> 2 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 4 </td>\n   <td style=\"text-align:left;\"> South </td>\n   <td style=\"text-align:left;\"> Tennessee </td>\n   <td style=\"text-align:right;\"> 3 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 4 </td>\n   <td style=\"text-align:left;\"> East </td>\n   <td style=\"text-align:left;\"> Villanova </td>\n   <td style=\"text-align:right;\"> 1 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 4 </td>\n   <td style=\"text-align:left;\"> West </td>\n   <td style=\"text-align:left;\"> Xavier </td>\n   <td style=\"text-align:right;\"> 1 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 4 </td>\n   <td style=\"text-align:left;\"> Midwest </td>\n   <td style=\"text-align:left;\"> Duke </td>\n   <td style=\"text-align:right;\"> 2 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 5 </td>\n   <td style=\"text-align:left;\"> South </td>\n   <td style=\"text-align:left;\"> Tennessee </td>\n   <td style=\"text-align:right;\"> 3 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 5 </td>\n   <td style=\"text-align:left;\"> Midwest </td>\n   <td style=\"text-align:left;\"> Duke </td>\n   <td style=\"text-align:right;\"> 2 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 6 </td>\n   <td style=\"text-align:left;\"> South </td>\n   <td style=\"text-align:left;\"> Tennessee </td>\n   <td style=\"text-align:right;\"> 3 </td>\n  </tr>\n</tbody>\n</table></div>\n\n`````\n:::\n:::\n\n\nWish me luck!\n\n# Linh & David's Method\n\nPackages needed for this method:\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nlibrary(tidyverse); library(repmis); library(httr)\n```\n:::\n\n\nSimilar to Matt's method, we also decided to go with a sliding range approach; however, we wanted to include historical win probabilities of first round play to determine the width of each team's number range, as well as the overlap between seeds.\n\n## The Basics\n\nWe have the most historical data on the matchups in the first round because they happen four times each year. Therefore, it makes the most sense to use these data to predict each matchup, especially for future rounds where certain matchups are rare. To do this, we created a range of values for each team in such a way that when one number is drawn from that range and compared against the number generated for its first round opponent, the odds of that team's number being higher than the opponent's match the historical probability of that team winning. In other words, every team has a range of values that can be chosen from, and this range overlaps with every other team by a very specific amount.\n\n### Example 1 - Overlap of 2\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](../../images/Overlap_2.png){fig-align='center' width=100%}\n:::\n:::\n\n\nIf team 1 (favorite) has a range of possible values from 5-10, and team 2 (underdog) has a range of 1-6, randomly choosing a number for each team will result in team 1 winning almost every time. The odds of team 2 winning are equal to the odds of team 1 drawing a 5 and team 2 drawing a 6. This equates to a mathematical \"and\" problem that can be calculated by multiplying the odds of each event happening. Since each team has 6 numbers to draw from, the odds are 1/6 for each, or 1/36 (2.78%) for both happening at the same time.\n\n### Example 2 - Overlap of 4\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](../../images/Overlap_4.png){fig-align='center' width=100%}\n:::\n:::\n\n\nIf we use these same dimensions, but want to increase the odds of the underdog winning, we could increase the amount of numbers that overlap by one number. Now the favorite chooses from 4-10 and the underdog chooses from 1-7. Here, the odds of the underdog winning increase to 12.24% because they can win if they draw a 5, 6, or 7 because it is possible for the favorite to draw a 4, 5, or 6.\n\n## The Math\n\nLegend for the following equations:\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nn = number of overlapping values\nM = Maximum value possible\nR = Size of range\n```\n:::\n\n\nTo make this method work for our purposes, we created an algorithm that defines a range of values for both teams in every first round matchup such that the odds of randomly selecting a value within these ranges matches the historical odds of that team winning. To do this, we determined the formula of the underdog winning (i.e., the number of outcomes in which the underdog would win, divided by the formula for the total number of possible outcomes).\n\n<font style=\"font-size: 14pt\">\n$$\n\\begin{aligned}\n\\text{Probability of UnderdogWin} = \\mathbf{\\frac{Underdog Wins}{Total Outcomes}}\n\\end{aligned}\n$$\n</font>\n\n<font style=\"font-size: 18pt\">\n$$\n\\begin{eqnarray}\n\\mathbf{P} = \\frac{(\\frac{n^2 - n}{2})}{R^2} \\Leftrightarrow \\frac{(\\frac{n^2 - n}{2})}{(\\frac{M+n}{2})^2}\n\\end{eqnarray}\n$$\n</font>\n\nWhen this equation is rearranged to solve for *n* (i.e., the range of numbers that needed to overlap for a given probability), you get a quadatratic equation that can be plugged into the quadratic formula.\n\n$$\n\\begin{align*}\n& \\mathbf{(P-2)n^2 + (2PM + 2)n + P(M^2)} \\text{,   where} \\\\\n\\\\\n& \\mathbf{a = P - 2} \\\\\n& \\mathbf{b = 2PM + 2} \\\\\n& \\mathbf{c = P(M^2)}\n\\end{align*}\n$$\n\nOnce *n* was determined, we needed to set the exact range for each team based on this overlap. To do this, we divided *m* by 2 and set half of *n* above and below this mid-point. Teams are assigned a value from this range in round 1, and then carry this value for each round to determine the winner of each matchup. Only in the event of a tie is a new number temporarily generated. \n\n<font style=\"font-size: 16pt\">\n$$\n\\begin{align}\n\\mathbf{UnderdogHigh} = \\frac{M+n}{2} \\\\\n\\\\\n\\mathbf{Favored Low} = \\frac{M-n+2}{2}\n\\end{align}\n$$\n</font>\n\nAnd that's it. Plug this into Matt's code for each round.\n\n## The Code\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\ncalcRanges <- function(UnderdogWinProb, MaxVal) {\n\ta <- UnderdogWinProb - 2\n\tb <- (2 * UnderdogWinProb * MaxVal) + 2\n\tc <- UnderdogWinProb * (MaxVal^2)\n\t\n\tquad_minus <- (-b - sqrt(b^2 - 4 * a * c)) / (2 * a)\n\tquad_plus <- (-b + sqrt(b^2 - 4 * a * c)) / (2 * a)\n\t\n\tif (isTRUE(sign(quad_plus) == 1)) {\n\t\tn_overlap <- quad_plus\n\t} else {\n\t\tn_overlap <- quad_minus\n\t}\n\t\n\t## Round n_overlap to nearest even integer\n\tn_overlap <- 2 * round(n_overlap/2)\n\t\n\tUnderdogHigh <- (MaxVal + n_overlap) / 2\n\tFavoredLow <- ((MaxVal - n_overlap) / 2) + 1\n\n\tcat(paste0(\"UnderdogHigh Value: \", UnderdogHigh))\n\tcat(paste0(\"\"),sep='\\n')\n\tcat(paste0(\"FavoredLow Value: \", FavoredLow))\n}\n```\n:::\n\n\n## The Simulations {.tabset .tabset-fade}\n\nWe've included two simulations: \n\n1. Implements historical match-up records of the first-round up to, but not including, the 2018 men's NCAA tournament\n2. Implements all first-round match-up records that include this year's (2018) tournament first round performance\n\nClick on the separate tabs below to see each one in turn:\n\n### Data Prior to 2018\n\nHere are the low and the high numbers matched with each seed:\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nlowNum <- c(4673, 3947, 3036, 2714, 1351, 1216, 1080, 76, 1, 1, 1, 1, 1, 1, 1, 1)\nhighNum <- c(10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000,\n             9925, 8921, 8785, 8650, 7287, 6965, 6054, 5328)\n```\n:::\n\n\nThat correspond to seed like this:\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table table-striped table-hover table-responsive\" style=\"margin-left: auto; margin-right: auto;\">\n <thead>\n  <tr>\n   <th style=\"text-align:right;\"> seed </th>\n   <th style=\"text-align:right;\"> lowNum </th>\n   <th style=\"text-align:right;\"> highNum </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 4673 </td>\n   <td style=\"text-align:right;\"> 10000 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 2 </td>\n   <td style=\"text-align:right;\"> 3947 </td>\n   <td style=\"text-align:right;\"> 10000 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 3 </td>\n   <td style=\"text-align:right;\"> 3036 </td>\n   <td style=\"text-align:right;\"> 10000 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 4 </td>\n   <td style=\"text-align:right;\"> 2714 </td>\n   <td style=\"text-align:right;\"> 10000 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 5 </td>\n   <td style=\"text-align:right;\"> 1351 </td>\n   <td style=\"text-align:right;\"> 10000 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 6 </td>\n   <td style=\"text-align:right;\"> 1216 </td>\n   <td style=\"text-align:right;\"> 10000 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 7 </td>\n   <td style=\"text-align:right;\"> 1080 </td>\n   <td style=\"text-align:right;\"> 10000 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 8 </td>\n   <td style=\"text-align:right;\"> 76 </td>\n   <td style=\"text-align:right;\"> 10000 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 9 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 9925 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 10 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 8921 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 11 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 8785 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 12 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 8650 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 13 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 7287 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 14 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 6965 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 15 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 6054 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 16 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 5328 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n#### Simulation\n\nThis method's simulation code is identical to Matt's, except that we will exchange the arbitrary sliding range with these newly created ranges based on first round historical probabilities:\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n# Sets the regions\nregions <- c('South', 'East', 'West', 'Midwest')\n\n# Import the team names and their seeds from 2018\n# These data are being pulled from this website's Github repo\nlink <- 'https://raw.githubusercontent.com/mkmiecik14/mkmiecik14.github.io/master/data/ncaa-2018-teams-updated.csv'\n\n# from https://stackoverflow.com/questions/60714074/download-csv-file-from-github-using-httr-get-request\ndata <- GET(link)\nncaa.2018 <- \n  read_csv(content(data, \"raw\")) %>%\n  rename(region = Region, team = Team1, seed = Seed)\n\n# Initializations\niters <- 1000\nresults <- probTableHolder <- vector('list', length = iters)\n```\n:::\n\n\nThis simulation was also ran 1000 times:\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nfor(i in 1:iters) {\n\n  # Creates whole tournament probability set\n  probTableHolder[[i]] <- probTable <- regions %>% \n    map_df(~tibble(seed = c(1:16),\n                   lowNum = lowNum,\n                   highNum = highNum) %>%\n             group_by(seed) %>% \n             mutate(result = sample(lowNum:highNum, 1)) %>%\n             ungroup()) %>%\n    mutate(region = rep(regions, each = 16)) %>%\n    inner_join(ncaa.2018, by = c('seed', 'region'))\n  \n  # Round 1\n  r1 <- regions %>%\n    map_df(~tibble(match.up = 1:8, t1.seed = 1:8, t2.seed = 16:9) %>%\n             mutate(t1.res =  probTable$result[1:8],\n                    t2.res = probTable$result[16:9],\n                    seed = if_else(t1.res > t2.res, t1.seed, t2.seed))) %>%\n             mutate(region = rep(regions, each = 8)) %>%\n             inner_join(probTable, by = c('seed', 'region'))\n    \n  # Round 1 results\n  r1.res <- r1 %>% select(match.up, region, team, seed, result)\n  \n  # Round 2\n  r2 <- regions %>%\n    map_df(~tibble(r2.match.up = 1:4,\n                r2.match.up.1 = 1:4,\n                r2.match.up.2 = as.integer(seq(8, 5, -1)),\n                region = .) %>%\n          left_join(r1.res, \n                    by = c('r2.match.up.1' = 'match.up', \n                           'region' = 'region')) %>%\n          rename(t1.team = team, t1.seed = seed, t1.res = result) %>%\n          left_join(r1.res,\n                    by = c('r2.match.up.2' = 'match.up', \n                           'region' = 'region')) %>%\n          rename(t2.team = team, t2.seed = seed, t2.res = result) %>%\n          mutate(seed = if_else(t1.res > t2.res, t1.seed, t2.seed))) %>%\n    inner_join(probTable, by = c('region', 'seed'))\n  \n  # Round 2 results\n  r2.res <- r2 %>% select(r2.match.up, region, team, seed, result)\n  \n  # Round 3\n  r3 <- regions %>%\n    map_df(~tibble(r3.match.up = 1:2, \n                r3.match.up.1 = 1:2, \n                r3.match.up.2 = 4:3,\n                region = .) %>%\n          left_join(r2.res, \n                    by = c('r3.match.up.1' = 'r2.match.up', \n                           'region' = 'region')) %>%\n          rename(t1.team = team, t1.seed = seed, t1.res = result) %>%\n          left_join(r2.res,\n                    by = c('r3.match.up.2' = 'r2.match.up', \n                           'region' = 'region')) %>%\n          rename(t2.team = team, t2.seed = seed, t2.res = result) %>%\n          mutate(seed = if_else(t1.res > t2.res, t1.seed, t2.seed))) %>%\n    inner_join(probTable,  by = c('region', 'seed'))\n  \n  # Round 3 results\n  r3.res <- r3 %>% select(r3.match.up, region, team, seed, result)\n  \n  # Round 4\n  r4 <- regions %>%\n    map_df(~tibble(r4.match.up = 1, \n                   r4.match.up.1 = 1, \n                   r4.match.up.2 = 2,\n                   region = .) %>%\n             inner_join(r3.res, \n                        by = c('r4.match.up.1' = 'r3.match.up', \n                               'region' = 'region')) %>%\n             rename(t1.team = team, t1.seed = seed, t1.res = result) %>%\n             inner_join(r3.res, by = c('r4.match.up.2' = 'r3.match.up',\n                                       'region' = 'region')) %>%\n             rename(t2.team = team, t2.seed = seed, t2.res = result) %>%\n             mutate(seed = if_else(t1.res > t2.res, t1.seed, t2.seed))) %>%\n    inner_join(probTable,  by = c('region', 'seed'))\n  \n  # Round 4 results\n  r4.res <- r4 %>% select(r4.match.up, region, team, seed, result)\n  \n  # Semifinal\n  semi.final <- tibble(t1.region = c('South', 'East'),\n                       t2.region = c('West', 'Midwest')) %>%\n    left_join(r4.res, by = c('t1.region' = 'region')) %>%\n    rename(t1.team = team, t1.seed = seed, t1.res = result) %>%\n    left_join(r4.res, by = c('t2.region' = 'region')) %>%\n    rename(t2.team = team, t2.seed = seed, t2.res = result) %>%\n    mutate(team = if_else(t1.res > t2.res, t1.team, t2.team)) %>%\n    inner_join(probTable, by = 'team')\n  \n  # Semifinal results\n  semi.final.res <- semi.final %>% select(region, team, seed, result)\n  \n  # Final\n  final <- tibble(t1.region = semi.final.res$team[1],\n                  t2.region = semi.final.res$team[2],\n                  t1.team = semi.final.res$team[1],\n                  t2.team = semi.final.res$team[2],\n                  t1.seed = semi.final.res$team[1],\n                  t2.seed = semi.final.res$team[2],\n                  t1.res = semi.final.res$result[1],\n                  t2.res = semi.final.res$result[2]) %>%\n    mutate(team = if_else(t1.res > t2.res, t1.team, t2.team)) %>%\n    inner_join(probTable, by = 'team')\n  \n  final.res <- final %>% select(region, team, seed, result)\n  \n  results[[i]] <- this.result <- bind_rows(r1.res, r2.res, r3.res, r4.res,\n                                           semi.final.res, final.res, \n                                           .id = 'round')\n  \n  #print(i) # Uncomment to see progress\n}\n```\n:::\n\n::: {.cell layout-align=\"center\"}\n\n:::\n\n\n#### Data Viz\n\nThe results of this simulation were saved out and can be imported from this website's [Github data repository](https://github.com/mkmiecik14/mkmiecik14.github.io/tree/master/data) like this:\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n# Loading probability tables from github\nprobTableLink2 <- 'https://github.com/mkmiecik14/mkmiecik14.github.io/blob/master/data/probTableHolder-linh-david-before-2018.RData?raw=true'\nsource_data(probTableLink2)\n\n# Loading simulation results from github\nresultsLink2 <- 'https://github.com/mkmiecik14/mkmiecik14.github.io/blob/master/data/results-linh-david-before-2018.RData?raw=true'\nsource_data(resultsLink2)\n```\n:::\n\n\nFirst, let's ensure that the probability table results worked across simulations and regions:\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n# Converts into a dataframe\nprobTable.long <- probTableHolder %>% map_df(bind_rows, .id = 'iter')\n\n# Calculates summary stats\nprobTable.sum <- probTable.long %>% \n  group_by(seed, region) %>%\n  summarize(m = mean(result),\n            sd = sd(result),\n            n = n(),\n            sem = sd/sqrt(n))\n\n# Probability table plot\nggplot(probTable.long, aes(factor(seed), result, color = region)) +\n  geom_point(position = 'jitter', alpha = 1/3, shape = 1) +\n  geom_pointrange(data = probTable.sum, \n                  aes(factor(seed), m, color = region, \n                      ymin = m - sd, ymax = m + sd),\n                  color = 'black') +\n  geom_line(data = probTable.sum, \n            aes(factor(seed), m, group = 1, color = region), \n            color = 'black', alpha = 1/2) +\n  scale_color_brewer(palette = 'Set2', name = 'Region') +\n  labs(x = 'Seed', y = 'Randomly Chosen Value', caption = 'SD Error Bars') +\n  theme_minimal() +\n  facet_wrap(~region)\n```\n\n::: {.cell-output-display}\n![](post-Simulating-2018-NCAA-March-Madness-Tournament-Performance-in-R_files/figure-html/unnamed-chunk-22-1.png){fig-align='center' width=672}\n:::\n:::\n\n\nThis above visualization depicts the potential ranges each seed can draw from using first round historical win probabilities. This drawing occurs at the beginning of each simulation iteration and determines each team's tournament performance.\n\nNow let's examine the results of the simulations.\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n# Converts to long dataframe\nresults.long <- results %>% map_df(bind_rows, .id = 'iter')\n\n# Win histogram\nggplot(results.long, aes(as.factor(seed), fill = region)) +\n  geom_histogram(stat = 'count') +\n  facet_grid(round~region) +\n  scale_x_discrete(breaks = seq(1, 16, 3)) +\n  labs(x = 'Seed', y = 'Win Frequency', title = 'Number of Wins Per Round') +\n  scale_fill_brewer(palette = 'Set2', name = 'Region') +\n  theme_minimal()\n```\n\n::: {.cell-output-display}\n![](post-Simulating-2018-NCAA-March-Madness-Tournament-Performance-in-R_files/figure-html/unnamed-chunk-23-1.png){fig-align='center' width=672}\n:::\n:::\n\n\nHigher seeds tend to win more often than lower seeds for each round. In contrast to Matt's simulation, there is more variability towards seed #7 and this variability becomes more pronounced with each subsequent round.\n\nNow for fun, let's see which teams won the tournament most often.\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n# Round 6 summary information\nresults.long.sum1 <- results.long %>% \n  filter(round == '6') %>% \n  group_by(team, region) %>%\n  summarise(n = n(), seed = unique(seed))\n\n# Winner plot\nggplot(results.long.sum1, aes(reorder(team, -1*n), n, fill = region)) +\n  geom_bar(stat = 'identity') +\n  scale_fill_brewer(palette = 'Set2', name = 'Region') +\n  labs(x = 'Team', y = 'NCAA Tournament Wins', \n       caption = paste('Simulation iterations:', iters)) +\n  geom_text(aes(label = seed), nudge_y = 4, color = 'grey') + \n  theme_minimal() +\n  theme(axis.text.x = element_text(angle = 45, hjust = 1))\n```\n\n::: {.cell-output-display}\n![](post-Simulating-2018-NCAA-March-Madness-Tournament-Performance-in-R_files/figure-html/unnamed-chunk-24-1.png){fig-align='center' width=150%}\n:::\n:::\n\n\nThis simulation has Villanova (#1) with the most wins, while Purdue (#2) comes in second. \n\nInterestingly, compared to Matt's simulation, this method allows for more variability for higher seeds to win the tournament:\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nggplot(results.long.sum1, aes(factor(seed), n)) +\n  geom_bar(stat = 'identity') +\n  labs(x = 'Seed', y = 'NCAA Tournament Wins',\n       caption = paste('Simulation iterations:', iters)) +\n  theme_minimal()\n```\n\n::: {.cell-output-display}\n![](post-Simulating-2018-NCAA-March-Madness-Tournament-Performance-in-R_files/figure-html/unnamed-chunk-25-1.png){fig-align='center' width=672}\n:::\n:::\n\n\nAccording to this method, #5 and #7 seeds won the tournament fewer times than #6 and #8 seeds. Nevertheless, this method results in several upsets winning the tournament, even as high as #9 seeds.\n\n#### Data Including 2018\n\nThis section was added after observing the first round of the 2018 Men's NCAA Tournament because, for the first time in history, a #16 seed beat a #1 seed. Therefore, we no longer had to guess this probability because it occured once out of 136 games--a probability of 0.0076.\n\nThe ranges for each team were adjusted to include data from the 2018 tournament:\n\nHere are the low and the high numbers matched with each seed:\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nlowNum <- c(4678, 3966, 3077, 2639, 1444, 1182, 1116, 1, 1, 1, 1, 1, 1, 1, 1, 1)\nhighNum <- c(10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000,\n             8885, 8819, 8557, 7363, 6924, 6035, 5323)\n```\n:::\n\n\nThat correspond to seed like this:\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table table-striped table-hover table-responsive\" style=\"margin-left: auto; margin-right: auto;\">\n <thead>\n  <tr>\n   <th style=\"text-align:right;\"> seed </th>\n   <th style=\"text-align:right;\"> lowNum </th>\n   <th style=\"text-align:right;\"> highNum </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 4678 </td>\n   <td style=\"text-align:right;\"> 10000 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 2 </td>\n   <td style=\"text-align:right;\"> 3966 </td>\n   <td style=\"text-align:right;\"> 10000 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 3 </td>\n   <td style=\"text-align:right;\"> 3077 </td>\n   <td style=\"text-align:right;\"> 10000 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 4 </td>\n   <td style=\"text-align:right;\"> 2639 </td>\n   <td style=\"text-align:right;\"> 10000 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 5 </td>\n   <td style=\"text-align:right;\"> 1444 </td>\n   <td style=\"text-align:right;\"> 10000 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 6 </td>\n   <td style=\"text-align:right;\"> 1182 </td>\n   <td style=\"text-align:right;\"> 10000 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 7 </td>\n   <td style=\"text-align:right;\"> 1116 </td>\n   <td style=\"text-align:right;\"> 10000 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 8 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 10000 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 9 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 10000 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 10 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 8885 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 11 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 8819 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 12 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 8557 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 13 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 7363 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 14 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 6924 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 15 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 6035 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 16 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 5323 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n#### Simulation\n\nThis method's simulation code is identical to Matt's, except that we will exchange the arbitrary sliding range with these newly created ranges based on first round historical probabilities:\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n# Sets the regions\nregions <- c('South', 'East', 'West', 'Midwest')\n\n# Import the team names and their seeds from 2018\n# These data are being pulled from this website's Github repo\nlink <- 'https://raw.githubusercontent.com/mkmiecik14/mkmiecik14.github.io/master/data/ncaa-2018-teams-updated.csv'\n\n# from https://stackoverflow.com/questions/60714074/download-csv-file-from-github-using-httr-get-request\ndata <- GET(link)\nncaa.2018 <- \n  read_csv(content(data, \"raw\")) %>%\n  rename(region = Region, team = Team1, seed = Seed)\n\n# Initializations\niters <- 1000\nresults <- probTableHolder <- vector('list', length = iters)\n```\n:::\n\n\nThis simulation was also ran 1000 times:\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nfor(i in 1:iters) {\n\n  # Creates whole tournament probability set\n  probTableHolder[[i]] <- probTable <- regions %>% \n    map_df(~tibble(seed = c(1:16),\n                   lowNum = lowNum,\n                   highNum = highNum) %>%\n             group_by(seed) %>% \n             mutate(result = sample(lowNum:highNum, 1)) %>%\n             ungroup()) %>%\n    mutate(region = rep(regions, each = 16)) %>%\n    inner_join(ncaa.2018, by = c('seed', 'region'))\n  \n  # Round 1\n  r1 <- regions %>%\n    map_df(~tibble(match.up = 1:8, t1.seed = 1:8, t2.seed = 16:9) %>%\n             mutate(t1.res =  probTable$result[1:8],\n                    t2.res = probTable$result[16:9],\n                    seed = if_else(t1.res > t2.res, t1.seed, t2.seed))) %>%\n             mutate(region = rep(regions, each = 8)) %>%\n             inner_join(probTable, by = c('seed', 'region'))\n    \n  # Round 1 results\n  r1.res <- r1 %>% select(match.up, region, team, seed, result)\n  \n  # Round 2\n  r2 <- regions %>%\n    map_df(~tibble(r2.match.up = 1:4,\n                r2.match.up.1 = 1:4,\n                r2.match.up.2 = as.integer(seq(8, 5, -1)),\n                region = .) %>%\n          left_join(r1.res, \n                    by = c('r2.match.up.1' = 'match.up', \n                           'region' = 'region')) %>%\n          rename(t1.team = team, t1.seed = seed, t1.res = result) %>%\n          left_join(r1.res,\n                    by = c('r2.match.up.2' = 'match.up', \n                           'region' = 'region')) %>%\n          rename(t2.team = team, t2.seed = seed, t2.res = result) %>%\n          mutate(seed = if_else(t1.res > t2.res, t1.seed, t2.seed))) %>%\n    inner_join(probTable, by = c('region', 'seed'))\n  \n  # Round 2 results\n  r2.res <- r2 %>% select(r2.match.up, region, team, seed, result)\n  \n  # Round 3\n  r3 <- regions %>%\n    map_df(~tibble(r3.match.up = 1:2, \n                r3.match.up.1 = 1:2, \n                r3.match.up.2 = 4:3,\n                region = .) %>%\n          left_join(r2.res, \n                    by = c('r3.match.up.1' = 'r2.match.up', \n                           'region' = 'region')) %>%\n          rename(t1.team = team, t1.seed = seed, t1.res = result) %>%\n          left_join(r2.res,\n                    by = c('r3.match.up.2' = 'r2.match.up', \n                           'region' = 'region')) %>%\n          rename(t2.team = team, t2.seed = seed, t2.res = result) %>%\n          mutate(seed = if_else(t1.res > t2.res, t1.seed, t2.seed))) %>%\n    inner_join(probTable,  by = c('region', 'seed'))\n  \n  # Round 3 results\n  r3.res <- r3 %>% select(r3.match.up, region, team, seed, result)\n  \n  # Round 4\n  r4 <- regions %>%\n    map_df(~tibble(r4.match.up = 1, \n                   r4.match.up.1 = 1, \n                   r4.match.up.2 = 2,\n                   region = .) %>%\n             inner_join(r3.res, \n                        by = c('r4.match.up.1' = 'r3.match.up', \n                               'region' = 'region')) %>%\n             rename(t1.team = team, t1.seed = seed, t1.res = result) %>%\n             inner_join(r3.res, by = c('r4.match.up.2' = 'r3.match.up',\n                                       'region' = 'region')) %>%\n             rename(t2.team = team, t2.seed = seed, t2.res = result) %>%\n             mutate(seed = if_else(t1.res > t2.res, t1.seed, t2.seed))) %>%\n    inner_join(probTable,  by = c('region', 'seed'))\n  \n  # Round 4 results\n  r4.res <- r4 %>% select(r4.match.up, region, team, seed, result)\n  \n  # Semifinal\n  semi.final <- tibble(t1.region = c('South', 'East'),\n                       t2.region = c('West', 'Midwest')) %>%\n    left_join(r4.res, by = c('t1.region' = 'region')) %>%\n    rename(t1.team = team, t1.seed = seed, t1.res = result) %>%\n    left_join(r4.res, by = c('t2.region' = 'region')) %>%\n    rename(t2.team = team, t2.seed = seed, t2.res = result) %>%\n    mutate(team = if_else(t1.res > t2.res, t1.team, t2.team)) %>%\n    inner_join(probTable, by = 'team')\n  \n  # Semifinal results\n  semi.final.res <- semi.final %>% select(region, team, seed, result)\n  \n  # Final\n  final <- tibble(t1.region = semi.final.res$team[1],\n                  t2.region = semi.final.res$team[2],\n                  t1.team = semi.final.res$team[1],\n                  t2.team = semi.final.res$team[2],\n                  t1.seed = semi.final.res$team[1],\n                  t2.seed = semi.final.res$team[2],\n                  t1.res = semi.final.res$result[1],\n                  t2.res = semi.final.res$result[2]) %>%\n    mutate(team = if_else(t1.res > t2.res, t1.team, t2.team)) %>%\n    inner_join(probTable, by = 'team')\n  \n  final.res <- final %>% select(region, team, seed, result)\n  \n  results[[i]] <- this.result <- bind_rows(r1.res, r2.res, r3.res, r4.res,\n                                           semi.final.res, final.res, \n                                           .id = 'round')\n  \n  #print(i) # Uncomment to see progress\n}\n```\n:::\n\n::: {.cell layout-align=\"center\"}\n\n:::\n\n\n#### Data Viz\n\nThe results of this simulation were saved out and can be imported from this website's [Github data repository](https://github.com/mkmiecik14/mkmiecik14.github.io/tree/master/data) like this:\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n# Loading probability tables from github\nprobTableLink2 <- 'https://github.com/mkmiecik14/mkmiecik14.github.io/blob/master/data/probTableHolder-linh-david-including-2018.RData?raw=true'\nsource_data(probTableLink2)\n\n# Loading simulation results from github\nresultsLink2 <- 'https://github.com/mkmiecik14/mkmiecik14.github.io/blob/master/data/results-linh-david-including-2018.RData?raw=true'\nsource_data(resultsLink2)\n```\n:::\n\n\nFirst, let's ensure that the probability table results worked across simulations and regions:\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n# Converts into a dataframe\nprobTable.long <- probTableHolder %>% map_df(bind_rows, .id = 'iter')\n\n# Calculates summary stats\nprobTable.sum <- probTable.long %>% \n  group_by(seed, region) %>%\n  summarize(m = mean(result),\n            sd = sd(result),\n            n = n(),\n            sem = sd/sqrt(n))\n\n# Probability table plot\nggplot(probTable.long, aes(factor(seed), result, color = region)) +\n  geom_point(position = 'jitter', alpha = 1/3, shape = 1) +\n  geom_pointrange(data = probTable.sum, \n                  aes(factor(seed), m, color = region, \n                      ymin = m - sd, ymax = m + sd),\n                  color = 'black') +\n  geom_line(data = probTable.sum, \n            aes(factor(seed), m, group = 1, color = region), \n            color = 'black', alpha = 1/2) +\n  scale_color_brewer(palette = 'Set2', name = 'Region') +\n  labs(x = 'Seed', y = 'Randomly Chosen Value', caption = 'SD Error Bars') +\n  theme_minimal() +\n  facet_wrap(~region)\n```\n\n::: {.cell-output-display}\n![](post-Simulating-2018-NCAA-March-Madness-Tournament-Performance-in-R_files/figure-html/unnamed-chunk-32-1.png){fig-align='center' width=672}\n:::\n:::\n\n\nThis above visualization depicts the potential ranges each seed can draw from using first round historical win probabilities. This drawing occurs at the beginning of each simulation iteration and determines each team's tournament performance.\n\nNow let's examine the results of the simulations.\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n# Converts to long dataframe\nresults.long <- results %>% map_df(bind_rows, .id = 'iter')\n\n# Win histogram\nggplot(results.long, aes(as.factor(seed), fill = region)) +\n  geom_histogram(stat = 'count') +\n  facet_grid(round~region) +\n  scale_x_discrete(breaks = seq(1, 16, 3)) +\n  labs(x = 'Seed', y = 'Win Frequency', title = 'Number of Wins Per Round') +\n  scale_fill_brewer(palette = 'Set2', name = 'Region') +\n  theme_minimal()\n```\n\n::: {.cell-output-display}\n![](post-Simulating-2018-NCAA-March-Madness-Tournament-Performance-in-R_files/figure-html/unnamed-chunk-33-1.png){fig-align='center' width=672}\n:::\n:::\n\n\nHigher seeds tend to win more often than lower seeds for each round.\n\nNow for fun, let's see which teams won the tournament most often.\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n# Round 6 summary information\nresults.long.sum1 <- results.long %>% \n  filter(round == '6') %>% \n  group_by(team, region) %>%\n  summarise(n = n(), seed = unique(seed))\n\n# Winner plot\nggplot(results.long.sum1, aes(reorder(team, -1*n), n, fill = region)) +\n  geom_bar(stat = 'identity') +\n  scale_fill_brewer(palette = 'Set2', name = 'Region') +\n  labs(x = 'Team', y = 'NCAA Tournament Wins', \n       caption = paste('Simulation iterations:', iters)) +\n  geom_text(aes(label = seed), nudge_y = 4, color = 'grey') + \n  theme_minimal() +\n  theme(axis.text.x = element_text(angle = 45, hjust = 1))\n```\n\n::: {.cell-output-display}\n![](post-Simulating-2018-NCAA-March-Madness-Tournament-Performance-in-R_files/figure-html/unnamed-chunk-34-1.png){fig-align='center' width=150%}\n:::\n:::\n\n\nThis simulation that incorporated the results from the first round of the 2018 men's NCAA tournament had Virginia (#1) winning with Xavier (#1) coming in second in overall tournament wins across all 1000 simulations.\n\nInterestingly, compared to Matt's simulation, this method allows for more variability for higher seeds to win the tournament:\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nggplot(results.long.sum1, aes(factor(seed), n)) +\n  geom_bar(stat = 'identity') +\n  labs(x = 'Seed', y = 'NCAA Tournament Wins',\n       caption = paste('Simulation iterations:', iters)) +\n  theme_minimal()\n```\n\n::: {.cell-output-display}\n![](post-Simulating-2018-NCAA-March-Madness-Tournament-Performance-in-R_files/figure-html/unnamed-chunk-35-1.png){fig-align='center' width=672}\n:::\n:::\n\n\nAccording to this method, overall wins track well with increasing seed. Lower seeds win more than higher seeds. However, upsets are definitely allowed to occur with #11 seeds winning the tournament! This is most likely a consequence of this year's (2018) tournament containing a variety of upsets, namely a 16^th^ seed over a 1^st^ seed victory.\n\n# Nick's Method\n\nR packages needed for this method:\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nlibrary(tidyverse); library(httr); library(repmis)\n```\n:::\n\n\nFor my bracket, I wanted to match the probability of any given seed (seed X) beating any other given seed (seed Y) to the actual proportion of times that seed X has beaten seed Y in real life. For example, 15^th^ seed teams have beaten 2^nd^ seed teams 8 times in 132 games, or 6.1% of the time.  Luckily for me, someone has already gone through every single game played and calculated the [proportions for every match-up](http://mcubed.net/ncaab/seeds.shtml). \n\nSo, with the help of my friend Giuseppe Miranda, I created a table containing all of these proportions where rows represent winners and columns represent losers. So, if you want the proportion of times that 1^st^ seed teams have beaten 16^th^ seed teams, look at [row 1, column 16] and you will see that 1^st^ seed teams have beaten 16^th^ seed teams 132 times in 132 games, or 100% of the time (132/132 = 1). Likewise, if you go to [row 8, column 9] you can see that 8^th^ seed teams have beaten 9^th^ seed teams 53.2% (or 0.532) of the time.\n\nThese data are available on this website's [Github data repository](https://github.com/mkmiecik14/mkmiecik14.github.io/tree/master/data) and can be read into R like this:\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n# Table of probabilites to reference for each seed vs. seed match-up\npropLink <- 'https://raw.githubusercontent.com/mkmiecik14/mkmiecik14.github.io/master/data/SeedMatchupProportions.csv'\n\n# from https://stackoverflow.com/questions/60714074/download-csv-file-from-github-using-httr-get-request\ndata <- GET(propLink)\ndata_temp <- read_csv(content(data, \"raw\"))\n\nProportionsData <- data_temp %>% select(-Seed) %>% as.matrix(.)\nrownames(ProportionsData) <- data_temp$Seed\n```\n:::\n\n\nThe historical proportions data looks like this:\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n`````{=html}\n<div style=\"border: 1px solid #ddd; padding: 0px; overflow-y: scroll; height:400px; \"><table class=\"table table-striped table-hover table-responsive\" style=\"margin-left: auto; margin-right: auto;\">\n <thead>\n  <tr>\n   <th style=\"text-align:right;position: sticky; top:0; background-color: #FFFFFF;\"> Seed </th>\n   <th style=\"text-align:right;position: sticky; top:0; background-color: #FFFFFF;\"> Seed1 </th>\n   <th style=\"text-align:right;position: sticky; top:0; background-color: #FFFFFF;\"> Seed2 </th>\n   <th style=\"text-align:right;position: sticky; top:0; background-color: #FFFFFF;\"> Seed3 </th>\n   <th style=\"text-align:right;position: sticky; top:0; background-color: #FFFFFF;\"> Seed4 </th>\n   <th style=\"text-align:right;position: sticky; top:0; background-color: #FFFFFF;\"> Seed5 </th>\n   <th style=\"text-align:right;position: sticky; top:0; background-color: #FFFFFF;\"> Seed6 </th>\n   <th style=\"text-align:right;position: sticky; top:0; background-color: #FFFFFF;\"> Seed7 </th>\n   <th style=\"text-align:right;position: sticky; top:0; background-color: #FFFFFF;\"> Seed8 </th>\n   <th style=\"text-align:right;position: sticky; top:0; background-color: #FFFFFF;\"> Seed9 </th>\n   <th style=\"text-align:right;position: sticky; top:0; background-color: #FFFFFF;\"> Seed10 </th>\n   <th style=\"text-align:right;position: sticky; top:0; background-color: #FFFFFF;\"> Seed11 </th>\n   <th style=\"text-align:right;position: sticky; top:0; background-color: #FFFFFF;\"> Seed12 </th>\n   <th style=\"text-align:right;position: sticky; top:0; background-color: #FFFFFF;\"> Seed13 </th>\n   <th style=\"text-align:right;position: sticky; top:0; background-color: #FFFFFF;\"> Seed14 </th>\n   <th style=\"text-align:right;position: sticky; top:0; background-color: #FFFFFF;\"> Seed15 </th>\n   <th style=\"text-align:right;position: sticky; top:0; background-color: #FFFFFF;\"> Seed16 </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 0.500 </td>\n   <td style=\"text-align:right;\"> 0.534 </td>\n   <td style=\"text-align:right;\"> 0.600 </td>\n   <td style=\"text-align:right;\"> 0.699 </td>\n   <td style=\"text-align:right;\"> 0.840 </td>\n   <td style=\"text-align:right;\"> 0.688 </td>\n   <td style=\"text-align:right;\"> 0.857 </td>\n   <td style=\"text-align:right;\"> 0.800 </td>\n   <td style=\"text-align:right;\"> 0.905 </td>\n   <td style=\"text-align:right;\"> 0.857 </td>\n   <td style=\"text-align:right;\"> 0.571 </td>\n   <td style=\"text-align:right;\"> 1.000 </td>\n   <td style=\"text-align:right;\"> 1.000 </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 1.0 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 2 </td>\n   <td style=\"text-align:right;\"> 0.466 </td>\n   <td style=\"text-align:right;\"> 0.500 </td>\n   <td style=\"text-align:right;\"> 0.629 </td>\n   <td style=\"text-align:right;\"> 0.444 </td>\n   <td style=\"text-align:right;\"> 0.200 </td>\n   <td style=\"text-align:right;\"> 0.722 </td>\n   <td style=\"text-align:right;\"> 0.710 </td>\n   <td style=\"text-align:right;\"> 0.444 </td>\n   <td style=\"text-align:right;\"> 0.500 </td>\n   <td style=\"text-align:right;\"> 0.607 </td>\n   <td style=\"text-align:right;\"> 0.867 </td>\n   <td style=\"text-align:right;\"> 1.000 </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.939 </td>\n   <td style=\"text-align:right;\"> 0.0 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 3 </td>\n   <td style=\"text-align:right;\"> 0.400 </td>\n   <td style=\"text-align:right;\"> 0.371 </td>\n   <td style=\"text-align:right;\"> 0.500 </td>\n   <td style=\"text-align:right;\"> 0.625 </td>\n   <td style=\"text-align:right;\"> 0.500 </td>\n   <td style=\"text-align:right;\"> 0.553 </td>\n   <td style=\"text-align:right;\"> 0.588 </td>\n   <td style=\"text-align:right;\"> 1.000 </td>\n   <td style=\"text-align:right;\"> 1.000 </td>\n   <td style=\"text-align:right;\"> 0.692 </td>\n   <td style=\"text-align:right;\"> 0.706 </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.841 </td>\n   <td style=\"text-align:right;\"> 1.000 </td>\n   <td style=\"text-align:right;\"> 0.0 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 4 </td>\n   <td style=\"text-align:right;\"> 0.301 </td>\n   <td style=\"text-align:right;\"> 0.556 </td>\n   <td style=\"text-align:right;\"> 0.375 </td>\n   <td style=\"text-align:right;\"> 0.500 </td>\n   <td style=\"text-align:right;\"> 0.565 </td>\n   <td style=\"text-align:right;\"> 0.333 </td>\n   <td style=\"text-align:right;\"> 0.333 </td>\n   <td style=\"text-align:right;\"> 0.364 </td>\n   <td style=\"text-align:right;\"> 0.666 </td>\n   <td style=\"text-align:right;\"> 1.000 </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.692 </td>\n   <td style=\"text-align:right;\"> 0.809 </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.0 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 5 </td>\n   <td style=\"text-align:right;\"> 0.160 </td>\n   <td style=\"text-align:right;\"> 0.800 </td>\n   <td style=\"text-align:right;\"> 0.500 </td>\n   <td style=\"text-align:right;\"> 0.435 </td>\n   <td style=\"text-align:right;\"> 0.500 </td>\n   <td style=\"text-align:right;\"> 1.000 </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.250 </td>\n   <td style=\"text-align:right;\"> 0.333 </td>\n   <td style=\"text-align:right;\"> 1.000 </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.671 </td>\n   <td style=\"text-align:right;\"> 0.800 </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.0 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 6 </td>\n   <td style=\"text-align:right;\"> 0.313 </td>\n   <td style=\"text-align:right;\"> 0.278 </td>\n   <td style=\"text-align:right;\"> 0.447 </td>\n   <td style=\"text-align:right;\"> 0.667 </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.500 </td>\n   <td style=\"text-align:right;\"> 0.625 </td>\n   <td style=\"text-align:right;\"> 0.333 </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.600 </td>\n   <td style=\"text-align:right;\"> 0.638 </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.875 </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.0 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 7 </td>\n   <td style=\"text-align:right;\"> 0.143 </td>\n   <td style=\"text-align:right;\"> 0.290 </td>\n   <td style=\"text-align:right;\"> 0.412 </td>\n   <td style=\"text-align:right;\"> 0.667 </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.375 </td>\n   <td style=\"text-align:right;\"> 0.500 </td>\n   <td style=\"text-align:right;\"> 1.000 </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.609 </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 1.000 </td>\n   <td style=\"text-align:right;\"> 0.660 </td>\n   <td style=\"text-align:right;\"> 0.0 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 8 </td>\n   <td style=\"text-align:right;\"> 0.200 </td>\n   <td style=\"text-align:right;\"> 0.556 </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.636 </td>\n   <td style=\"text-align:right;\"> 0.750 </td>\n   <td style=\"text-align:right;\"> 0.750 </td>\n   <td style=\"text-align:right;\"> 0.500 </td>\n   <td style=\"text-align:right;\"> 0.500 </td>\n   <td style=\"text-align:right;\"> 0.532 </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 1.000 </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 1.000 </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.0 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 9 </td>\n   <td style=\"text-align:right;\"> 0.095 </td>\n   <td style=\"text-align:right;\"> 0.500 </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.333 </td>\n   <td style=\"text-align:right;\"> 0.666 </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.468 </td>\n   <td style=\"text-align:right;\"> 0.500 </td>\n   <td style=\"text-align:right;\"> 1.000 </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 1.000 </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.0 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 10 </td>\n   <td style=\"text-align:right;\"> 0.143 </td>\n   <td style=\"text-align:right;\"> 0.393 </td>\n   <td style=\"text-align:right;\"> 0.308 </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.400 </td>\n   <td style=\"text-align:right;\"> 0.391 </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.500 </td>\n   <td style=\"text-align:right;\"> 0.333 </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 1.000 </td>\n   <td style=\"text-align:right;\"> 1.000 </td>\n   <td style=\"text-align:right;\"> 0.0 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 11 </td>\n   <td style=\"text-align:right;\"> 0.429 </td>\n   <td style=\"text-align:right;\"> 0.133 </td>\n   <td style=\"text-align:right;\"> 0.294 </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.362 </td>\n   <td style=\"text-align:right;\"> 1.000 </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.667 </td>\n   <td style=\"text-align:right;\"> 0.500 </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 1.000 </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.0 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 12 </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.308 </td>\n   <td style=\"text-align:right;\"> 0.329 </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 1.000 </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.500 </td>\n   <td style=\"text-align:right;\"> 0.727 </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.0 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 13 </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.191 </td>\n   <td style=\"text-align:right;\"> 0.200 </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.273 </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.500 </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.0 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 14 </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.159 </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.125 </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.500 </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.0 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 15 </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.061 </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.333 </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.500 </td>\n   <td style=\"text-align:right;\"> 0.0 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 16 </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.5 </td>\n  </tr>\n</tbody>\n</table></div>\n\n`````\n:::\n:::\n\n\nNext, we will need a data frame for each round of the tournament, where each row represents each game played in the tournament. Each row will contain the name of the teams that are playing each other (‘Team1’ and ‘Team2’ columns) and the seed numbers of both of those teams (‘Team1Seed’ and ‘Team2Seed’). Later we will loop through these data frames to simulate each round of the tournament and predict the winner of each game. \n\nFor the first round, it was easier to create the data in excel beforehand and is available via .csv download from this website's [Github data repository](https://github.com/mkmiecik14/mkmiecik14.github.io/tree/master/data) or you can retrieve from R like this:\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n# We will load a data frame containing each match-up for the round of 64\nr1Link <- 'https://raw.githubusercontent.com/mkmiecik14/mkmiecik14.github.io/master/data/NCAA2018Bracket.csv'\n\n# from https://stackoverflow.com/questions/60714074/download-csv-file-from-github-using-httr-get-request\ndata <- GET(r1Link)\ndata_temp <- read_csv(content(data, \"raw\"))\n\nRound1Data <- data_temp %>% select(-Game) %>% as.data.frame(.)\nrownames(Round1Data) <- data_temp$Game\n\n# We also need to coerce the Team Name columns into character vectors\nRound1Data$Team1 <- as.character(Round1Data$Team1)\nRound1Data$Team2 <- as.character(Round1Data$Team2)\n```\n:::\n\n\n`Round1Data` looks like this:\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n`````{=html}\n<div style=\"border: 1px solid #ddd; padding: 0px; overflow-y: scroll; height:400px; \"><table class=\"table table-striped table-hover table-responsive\" style=\"margin-left: auto; margin-right: auto;\">\n <thead>\n  <tr>\n   <th style=\"text-align:left;position: sticky; top:0; background-color: #FFFFFF;\">   </th>\n   <th style=\"text-align:left;position: sticky; top:0; background-color: #FFFFFF;\"> Region </th>\n   <th style=\"text-align:left;position: sticky; top:0; background-color: #FFFFFF;\"> Team1 </th>\n   <th style=\"text-align:left;position: sticky; top:0; background-color: #FFFFFF;\"> Team2 </th>\n   <th style=\"text-align:right;position: sticky; top:0; background-color: #FFFFFF;\"> Team1Seed </th>\n   <th style=\"text-align:right;position: sticky; top:0; background-color: #FFFFFF;\"> Team2Seed </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> 1 </td>\n   <td style=\"text-align:left;\"> South </td>\n   <td style=\"text-align:left;\"> Virginia </td>\n   <td style=\"text-align:left;\"> UMBC </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 16 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 2 </td>\n   <td style=\"text-align:left;\"> South </td>\n   <td style=\"text-align:left;\"> Creighton </td>\n   <td style=\"text-align:left;\"> Kansas State </td>\n   <td style=\"text-align:right;\"> 8 </td>\n   <td style=\"text-align:right;\"> 9 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 3 </td>\n   <td style=\"text-align:left;\"> South </td>\n   <td style=\"text-align:left;\"> Kentucky </td>\n   <td style=\"text-align:left;\"> Davidson </td>\n   <td style=\"text-align:right;\"> 5 </td>\n   <td style=\"text-align:right;\"> 12 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 4 </td>\n   <td style=\"text-align:left;\"> South </td>\n   <td style=\"text-align:left;\"> Arizona </td>\n   <td style=\"text-align:left;\"> Buffalo </td>\n   <td style=\"text-align:right;\"> 4 </td>\n   <td style=\"text-align:right;\"> 13 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 5 </td>\n   <td style=\"text-align:left;\"> South </td>\n   <td style=\"text-align:left;\"> Miami </td>\n   <td style=\"text-align:left;\"> Loyola Chicago </td>\n   <td style=\"text-align:right;\"> 6 </td>\n   <td style=\"text-align:right;\"> 11 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 6 </td>\n   <td style=\"text-align:left;\"> South </td>\n   <td style=\"text-align:left;\"> Tennessee </td>\n   <td style=\"text-align:left;\"> Wright State </td>\n   <td style=\"text-align:right;\"> 3 </td>\n   <td style=\"text-align:right;\"> 14 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 7 </td>\n   <td style=\"text-align:left;\"> South </td>\n   <td style=\"text-align:left;\"> Nevada </td>\n   <td style=\"text-align:left;\"> Texas </td>\n   <td style=\"text-align:right;\"> 7 </td>\n   <td style=\"text-align:right;\"> 10 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 8 </td>\n   <td style=\"text-align:left;\"> South </td>\n   <td style=\"text-align:left;\"> Cincinnati </td>\n   <td style=\"text-align:left;\"> Georgia State </td>\n   <td style=\"text-align:right;\"> 2 </td>\n   <td style=\"text-align:right;\"> 15 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 25 </td>\n   <td style=\"text-align:left;\"> West </td>\n   <td style=\"text-align:left;\"> Xavier </td>\n   <td style=\"text-align:left;\"> Play in 4 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 16 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 26 </td>\n   <td style=\"text-align:left;\"> West </td>\n   <td style=\"text-align:left;\"> Missouri </td>\n   <td style=\"text-align:left;\"> Florida State </td>\n   <td style=\"text-align:right;\"> 8 </td>\n   <td style=\"text-align:right;\"> 9 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 27 </td>\n   <td style=\"text-align:left;\"> West </td>\n   <td style=\"text-align:left;\"> Ohio State </td>\n   <td style=\"text-align:left;\"> South Dakota State </td>\n   <td style=\"text-align:right;\"> 5 </td>\n   <td style=\"text-align:right;\"> 12 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 28 </td>\n   <td style=\"text-align:left;\"> West </td>\n   <td style=\"text-align:left;\"> Gonzaga </td>\n   <td style=\"text-align:left;\"> UNC Greensboro </td>\n   <td style=\"text-align:right;\"> 4 </td>\n   <td style=\"text-align:right;\"> 13 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 29 </td>\n   <td style=\"text-align:left;\"> West </td>\n   <td style=\"text-align:left;\"> Houston </td>\n   <td style=\"text-align:left;\"> San Diego State </td>\n   <td style=\"text-align:right;\"> 6 </td>\n   <td style=\"text-align:right;\"> 11 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 30 </td>\n   <td style=\"text-align:left;\"> West </td>\n   <td style=\"text-align:left;\"> Michigan </td>\n   <td style=\"text-align:left;\"> Montana </td>\n   <td style=\"text-align:right;\"> 3 </td>\n   <td style=\"text-align:right;\"> 14 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 31 </td>\n   <td style=\"text-align:left;\"> West </td>\n   <td style=\"text-align:left;\"> Texas A&amp;M </td>\n   <td style=\"text-align:left;\"> Providence </td>\n   <td style=\"text-align:right;\"> 7 </td>\n   <td style=\"text-align:right;\"> 10 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 32 </td>\n   <td style=\"text-align:left;\"> West </td>\n   <td style=\"text-align:left;\"> North Carolina </td>\n   <td style=\"text-align:left;\"> Lipscomb </td>\n   <td style=\"text-align:right;\"> 2 </td>\n   <td style=\"text-align:right;\"> 15 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 9 </td>\n   <td style=\"text-align:left;\"> East </td>\n   <td style=\"text-align:left;\"> Villanova </td>\n   <td style=\"text-align:left;\"> Play in 1 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 16 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 10 </td>\n   <td style=\"text-align:left;\"> East </td>\n   <td style=\"text-align:left;\"> Virginia Tech </td>\n   <td style=\"text-align:left;\"> Alabama </td>\n   <td style=\"text-align:right;\"> 8 </td>\n   <td style=\"text-align:right;\"> 9 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 11 </td>\n   <td style=\"text-align:left;\"> East </td>\n   <td style=\"text-align:left;\"> West Virginia </td>\n   <td style=\"text-align:left;\"> Murray State </td>\n   <td style=\"text-align:right;\"> 5 </td>\n   <td style=\"text-align:right;\"> 12 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 12 </td>\n   <td style=\"text-align:left;\"> East </td>\n   <td style=\"text-align:left;\"> Wichita State </td>\n   <td style=\"text-align:left;\"> Marshall </td>\n   <td style=\"text-align:right;\"> 4 </td>\n   <td style=\"text-align:right;\"> 13 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 13 </td>\n   <td style=\"text-align:left;\"> East </td>\n   <td style=\"text-align:left;\"> Florida </td>\n   <td style=\"text-align:left;\"> Play in 2 </td>\n   <td style=\"text-align:right;\"> 6 </td>\n   <td style=\"text-align:right;\"> 11 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 14 </td>\n   <td style=\"text-align:left;\"> East </td>\n   <td style=\"text-align:left;\"> Texas Tech </td>\n   <td style=\"text-align:left;\"> SF Austin </td>\n   <td style=\"text-align:right;\"> 3 </td>\n   <td style=\"text-align:right;\"> 14 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 15 </td>\n   <td style=\"text-align:left;\"> East </td>\n   <td style=\"text-align:left;\"> Arkansas </td>\n   <td style=\"text-align:left;\"> Butler </td>\n   <td style=\"text-align:right;\"> 7 </td>\n   <td style=\"text-align:right;\"> 10 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 16 </td>\n   <td style=\"text-align:left;\"> East </td>\n   <td style=\"text-align:left;\"> Purdue </td>\n   <td style=\"text-align:left;\"> CS Fullerton </td>\n   <td style=\"text-align:right;\"> 2 </td>\n   <td style=\"text-align:right;\"> 15 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 17 </td>\n   <td style=\"text-align:left;\"> Midwest </td>\n   <td style=\"text-align:left;\"> Kansas </td>\n   <td style=\"text-align:left;\"> Penn </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 16 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 18 </td>\n   <td style=\"text-align:left;\"> Midwest </td>\n   <td style=\"text-align:left;\"> Seton Hall </td>\n   <td style=\"text-align:left;\"> NC State </td>\n   <td style=\"text-align:right;\"> 8 </td>\n   <td style=\"text-align:right;\"> 9 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 19 </td>\n   <td style=\"text-align:left;\"> Midwest </td>\n   <td style=\"text-align:left;\"> Clemson </td>\n   <td style=\"text-align:left;\"> New Mexico State </td>\n   <td style=\"text-align:right;\"> 5 </td>\n   <td style=\"text-align:right;\"> 12 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 20 </td>\n   <td style=\"text-align:left;\"> Midwest </td>\n   <td style=\"text-align:left;\"> Auburn </td>\n   <td style=\"text-align:left;\"> Charleston </td>\n   <td style=\"text-align:right;\"> 4 </td>\n   <td style=\"text-align:right;\"> 13 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 21 </td>\n   <td style=\"text-align:left;\"> Midwest </td>\n   <td style=\"text-align:left;\"> TCU </td>\n   <td style=\"text-align:left;\"> Play in 3 </td>\n   <td style=\"text-align:right;\"> 6 </td>\n   <td style=\"text-align:right;\"> 11 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 22 </td>\n   <td style=\"text-align:left;\"> Midwest </td>\n   <td style=\"text-align:left;\"> Michigan State </td>\n   <td style=\"text-align:left;\"> Bucknell </td>\n   <td style=\"text-align:right;\"> 3 </td>\n   <td style=\"text-align:right;\"> 14 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 23 </td>\n   <td style=\"text-align:left;\"> Midwest </td>\n   <td style=\"text-align:left;\"> Rhode Island </td>\n   <td style=\"text-align:left;\"> Oklahoma </td>\n   <td style=\"text-align:right;\"> 7 </td>\n   <td style=\"text-align:right;\"> 10 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 24 </td>\n   <td style=\"text-align:left;\"> Midwest </td>\n   <td style=\"text-align:left;\"> Duke </td>\n   <td style=\"text-align:left;\"> Iona </td>\n   <td style=\"text-align:right;\"> 2 </td>\n   <td style=\"text-align:right;\"> 15 </td>\n  </tr>\n</tbody>\n</table></div>\n\n`````\n:::\n:::\n\n\nBut we can make the rest of the data frames for the remaining rounds in R:\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nRound2Data <- data.frame(game = 1:16, \n                         Region = rep(c('South', 'West', 'East', 'Midwest'), \n                                      each = 4),\n                         Team1 = character(length = 16),\n                         Team2 = character(length = 16),\n                         Team1Seed = integer(length = 16),\n                         Team2Seed = integer(length = 16),\n                         Winner = character(length = 16),\n                         stringsAsFactors = F)\n\nRound3Data <- data.frame(game = 1:8, \n                         Region = rep(c('South', 'West', 'East', 'Midwest'), \n                                      each = 2),\n                         Team1 = character(length = 8),\n                         Team2 = character(length = 8),\n                         Team1Seed = integer(length = 8),\n                         Team2Seed = integer(length = 8),\n                         Winner = character(length = 8),\n                         stringsAsFactors = F)\n\nRound4Data <- data.frame(game = 1:4, \n                         Region = c('South', 'West', 'East', 'Midwest'),\n                         Team1 = character(length = 4),\n                         Team2 = character(length = 4),\n                         Team1Seed = integer(length = 4),\n                         Team2Seed = integer(length = 4),\n                         Winner = character(length = 4),\n                         stringsAsFactors = F)\n\nRound5Data <- data.frame(game = 1:2,\n                         Team1 = character(length = 2),\n                         Team2 = character(length = 2),\n                         Team1Seed = integer(length = 2),\n                         Team2Seed = integer(length = 2),\n                         Winner = character(length = 2),\n                         stringsAsFactors = F)\n\nRound6Data <- data.frame(game = 1,\n                         Team1 = character(length = 1),\n                         Team2 = character(length = 1),\n                         Team1Seed = integer(length = 1),\n                         Team2Seed = integer(length = 1),\n                         Winner = character(length = 1),\n                         stringsAsFactors = F)\n```\n:::\n\n\n## Simulation\n\nWe are then going to loop through our dataset for round 1 and calculate a `score` for each game played by randomly selecting a decimal number between 0 and 1. After we assign our `score` we will then refer to the cell of our `ProportionsData`, where row = seed of team 1 and column = seed of team 2. This cell should give us the proportion (in decimal form) of times that a team with a seed number equal to the seed of team 1 beat a team with a seed number equal to the seed of team 2. If our score variable is less than or equal to the proportion in this cell then team 1 wins, if not then team 2 wins. In other words, the probability of team 1 beating team 2 should be equivalent to the proportion of times that team 1’s seed beat team 2’s seed in real life.\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n## Round of 64##\nprint(\"Round of 64\")\nfor (match in 1:nrow(Round1Data)){\n  #Select 1 random decimal between 0 and 1.\n  score <- runif(1,0,1)\n  print(score)\n  #Compare our 'score' variable to the real-life proportion data.\n  #If score is less than the proportion of times the seed of team 1 \n  #beat the seeed of team 2 then team 1 wins. Otherwise, team 2 wins.\n  if (score <= ProportionsData[Round1Data$Team1Seed[match],\n                               Round1Data$Team2Seed[match]]) {\n    print(paste(Round1Data$Team1[match], \" beats \", \n                Round1Data$Team2[match], sep = \"\"))\n    Round1Data$Winner[match] <- Round1Data$Team1[match]\n  }else {\n    print(paste(Round1Data$Team2[match], \" beats \", \n                Round1Data$Team1[match], sep = \"\"))\n    Round1Data$Winner[match] <- Round1Data$Team2[match]\n  }\n}\n```\n:::\n\n\nNext, we will use the results from round 1 (we now have a winner column in our Round1Data filled in with the winner of each game) to fill in our data frame for round 2.\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n# Fill in the data frame for the next round using the results of the \n# previous round.\nfor (winner in 1:nrow(Round2Data)) {\n  team1Winner <- as.character(Round1Data$Winner[winner*2-1])\n  \n  if (Round1Data$Winner[winner*2-1] %in% Round1Data$Team1){\n    team1Seed <- Round1Data$Team1Seed[winner*2-1]\n  }else {\n    team1Seed <- Round1Data$Team2Seed[winner*2-1]\n  }\n  \n  team2Winner <- Round1Data$Winner[winner*2]\n  \n  if (Round1Data$Winner[winner*2] %in% Round1Data$Team1){\n    team2Seed <- Round1Data$Team1Seed[winner*2]\n  }else {\n    team2Seed <- Round1Data$Team2Seed[winner*2]\n  }\n  \n  # I discovered that the team 1 needs to be the lower seed \n  # (i.e. higher seed number).\n  if(team1Seed > team2Seed){\n    Round2Data$Team1[winner] <- team1Winner\n    Round2Data$Team1Seed[winner] <- team1Seed\n    Round2Data$Team2[winner] <- team2Winner\n    Round2Data$Team2Seed[winner] <- team2Seed\n  } else {\n    Round2Data$Team1[winner] <- team2Winner\n    Round2Data$Team1Seed[winner] <- team2Seed\n    Round2Data$Team2[winner] <- team1Winner\n    Round2Data$Team2Seed[winner] <- team1Seed\n  }\n  \n}\n```\n:::\n\n\nAnd finally, we're simply going to repeat those last two steps for every remaining round in the tournament.\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n## Round of 32 ##\nprint(\"Round of 32\")\nfor (match in 1:nrow(Round2Data)){\n  score <- runif(1,0,1)\n  print(score)\n  if (score <= ProportionsData[Round2Data$Team1Seed[match],\n                               Round2Data$Team2Seed[match]]) {\n    print(paste(Round2Data$Team1[match], \" beats \", \n                Round2Data$Team2[match], sep = \"\"))\n    Round2Data$Winner[match] <- Round2Data$Team1[match]\n  }else {\n    print(paste(Round2Data$Team2[match], \" beats \", \n                Round2Data$Team1[match], sep = \"\"))\n    Round2Data$Winner[match] <- Round2Data$Team2[match]\n  }\n}\n\n# Fill in the data frame for the next round using the results of the \n# previous round\nfor (winner in 1:nrow(Round3Data)) {\n  team1Winner <- as.character(Round2Data$Winner[winner*2-1])\n  \n  if (Round2Data$Winner[winner*2-1] %in% Round2Data$Team1){\n    team1Seed <- Round2Data$Team1Seed[winner*2-1]\n  }else {\n    team1Seed <- Round2Data$Team2Seed[winner*2-1]\n  }\n  \n  team2Winner <- Round2Data$Winner[winner*2]\n  \n  if (Round2Data$Winner[winner*2] %in% Round2Data$Team1){\n    team2Seed <- Round2Data$Team1Seed[winner*2]\n  }else {\n    team2Seed <- Round2Data$Team2Seed[winner*2]\n  }\n  \n  # I discovered that the team 1 needs to be the lower seed \n  # (i.e. higher seed number)\n  if(team1Seed > team2Seed){\n    Round3Data$Team1[winner] <- team1Winner\n    Round3Data$Team1Seed[winner] <- team1Seed\n    Round3Data$Team2[winner] <- team2Winner\n    Round3Data$Team2Seed[winner] <- team2Seed\n  } else {\n    Round3Data$Team1[winner] <- team2Winner\n    Round3Data$Team1Seed[winner] <- team2Seed\n    Round3Data$Team2[winner] <- team1Winner\n    Round3Data$Team2Seed[winner] <- team1Seed\n  }\n  \n}\n\n\n## Round of 16 ##\nprint(\"Sweet 16\")\nfor (match in 1:nrow(Round3Data)){\n  score <- runif(1,0,1)\n  print(score)\n  if (score <= ProportionsData[Round3Data$Team1Seed[match],\n                               Round3Data$Team2Seed[match]]) {\n    print(paste(Round3Data$Team1[match], \" beats \", \n                Round3Data$Team2[match], sep = \"\"))\n    Round3Data$Winner[match] <- Round3Data$Team1[match]\n  }else {\n    print(paste(Round3Data$Team2[match], \" beats \", \n                Round3Data$Team1[match], sep = \"\"))\n    Round3Data$Winner[match] <- Round3Data$Team2[match]\n  }\n}\n\n# Fill in the data frame for the next round using the results of the \n# previous round\nfor (winner in 1:nrow(Round4Data)) {\n  team1Winner <- as.character(Round3Data$Winner[winner*2-1])\n  \n  if (Round3Data$Winner[winner*2-1] %in% Round3Data$Team1){\n    team1Seed <- Round3Data$Team1Seed[winner*2-1]\n  }else {\n    team1Seed <- Round3Data$Team2Seed[winner*2-1]\n  }\n  \n  team2Winner <- Round3Data$Winner[winner*2]\n  \n  if (Round3Data$Winner[winner*2] %in% Round3Data$Team1){\n    team2Seed <- Round3Data$Team1Seed[winner*2]\n  }else {\n    team2Seed <- Round3Data$Team2Seed[winner*2]\n  }\n  \n  # I discovered that the team 1 needs to be the lower seed \n  # (i.e. higher seed number)\n  if(team1Seed > team2Seed){\n    Round4Data$Team1[winner] <- team1Winner\n    Round4Data$Team1Seed[winner] <- team1Seed\n    Round4Data$Team2[winner] <- team2Winner\n    Round4Data$Team2Seed[winner] <- team2Seed\n  } else {\n    Round4Data$Team1[winner] <- team2Winner\n    Round4Data$Team1Seed[winner] <- team2Seed\n    Round4Data$Team2[winner] <- team1Winner\n    Round4Data$Team2Seed[winner] <- team1Seed\n  }\n  \n}\n\n\n## Round of 8 ##\nprint(\"Elite 8\")\nfor (match in 1:nrow(Round4Data)){\n  score <- runif(1,0,1)\n  print(score)\n  if (score <= ProportionsData[Round4Data$Team1Seed[match],\n                               Round4Data$Team2Seed[match]]) {\n    print(paste(Round4Data$Team1[match], \" beats \", \n                Round4Data$Team2[match], sep = \"\"))\n    Round4Data$Winner[match] <- Round4Data$Team1[match]\n  }else {\n    print(paste(Round4Data$Team2[match], \" beats \", \n                Round4Data$Team1[match], sep = \"\"))\n    Round4Data$Winner[match] <- Round4Data$Team2[match]\n  }\n}\n\n# Fill in the data frame for the next round using the results of the \n# previous round\nfor (winner in 1:nrow(Round5Data)) {\n  team1Winner <- as.character(Round4Data$Winner[winner*2-1])\n  \n  if (Round4Data$Winner[winner*2-1] %in% Round4Data$Team1){\n    team1Seed <- Round4Data$Team1Seed[winner*2-1]\n  }else {\n    team1Seed <- Round4Data$Team2Seed[winner*2-1]\n  }\n  \n  team2Winner <- Round4Data$Winner[winner*2]\n  \n  if (Round4Data$Winner[winner*2] %in% Round4Data$Team1){\n    team2Seed <- Round4Data$Team1Seed[winner*2]\n  }else {\n    team2Seed <- Round4Data$Team2Seed[winner*2]\n  }\n  \n  # I discovered that the team 1 needs to be the lower seed \n  # (i.e. higher seed number)\n  if(team1Seed > team2Seed){\n    Round5Data$Team1[winner] <- team1Winner\n    Round5Data$Team1Seed[winner] <- team1Seed\n    Round5Data$Team2[winner] <- team2Winner\n    Round5Data$Team2Seed[winner] <- team2Seed\n  } else {\n    Round5Data$Team1[winner] <- team2Winner\n    Round5Data$Team1Seed[winner] <- team2Seed\n    Round5Data$Team2[winner] <- team1Winner\n    Round5Data$Team2Seed[winner] <- team1Seed\n  }\n  \n}\n\n\n## Semi-Finals ##\nprint(\"Final Four\")\nfor (match in 1:nrow(Round5Data)){\n  score <- runif(1,0,1)\n  print(score)\n  if (score <= ProportionsData[Round5Data$Team1Seed[match],\n                               Round5Data$Team2Seed[match]]) {\n    print(paste(Round5Data$Team1[match], \" beats \", \n                Round5Data$Team2[match], sep = \"\"))\n    Round5Data$Winner[match] <- Round5Data$Team1[match]\n  }else {\n    print(paste(Round5Data$Team2[match], \" beats \", \n                Round5Data$Team1[match], sep = \"\"))\n    Round5Data$Winner[match] <- Round5Data$Team2[match]\n  }\n}\n\n# Fill in the data frame for the next round using the results of the \n# previous round\nfor (winner in 1:nrow(Round6Data)) {\n  team1Winner <- as.character(Round5Data$Winner[winner*2-1])\n  \n  if (Round5Data$Winner[winner*2-1] %in% Round5Data$Team1){\n    team1Seed <- Round5Data$Team1Seed[winner*2-1]\n  }else {\n    team1Seed <- Round5Data$Team2Seed[winner*2-1]\n  }\n  \n  team2Winner <- Round5Data$Winner[winner*2]\n  \n  if (Round5Data$Winner[winner*2] %in% Round5Data$Team1){\n    team2Seed <- Round5Data$Team1Seed[winner*2]\n  }else {\n    team2Seed <- Round5Data$Team2Seed[winner*2]\n  }\n  \n  # I discovered that the team 1 needs to be the lower seed \n  # (i.e. higher seed number)\n  if(team1Seed > team2Seed){\n    Round6Data$Team1[winner] <- team1Winner\n    Round6Data$Team1Seed[winner] <- team1Seed\n    Round6Data$Team2[winner] <- team2Winner\n    Round6Data$Team2Seed[winner] <- team2Seed\n  } else {\n    Round6Data$Team1[winner] <- team2Winner\n    Round6Data$Team1Seed[winner] <- team2Seed\n    Round6Data$Team2[winner] <- team1Winner\n    Round6Data$Team2Seed[winner] <- team1Seed\n  }\n  \n}\n\n\n## Finals ##\nprint(\"National Final\")\nscore <- runif(1,0,1)\nprint(score)\nif (score <= ProportionsData[Round6Data$Team1Seed[1],\n                             Round6Data$Team2Seed[1]]) {\n  print(paste(Round6Data$Team1[1],  \" beats \", \n              Round6Data$Team2[1], \" in the Final Round!\", sep = ''))\n  Round6Data$Winner[1] <- Round6Data$Team1[1]\n}else {\n  print(paste(Round6Data$Team2[1],  \" beats \", \n              Round6Data$Team1[1], \" in the Final Round!\", sep = ''))\n  Round6Data$Winner[1] <- Round6Data$Team2[1]\n}\n```\n:::\n\n\nThe above steps were repeated 1000 times to simulate performance.\n\n## Data Viz\n\nThe results from this simulation were saved into a variable named `resultsHolder` that can be retrieved from this website's [Github data repository](https://github.com/mkmiecik14/mkmiecik14.github.io/tree/master/data) like this:\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nnickResLink <- 'https://github.com/mkmiecik14/mkmiecik14.github.io/blob/master/data/resultsHolder.RData?raw=true'\nsource_data(nickResLink)\n```\n:::\n\n\nLet's see what teams won the tournament most often:\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n# Converting list to long data frame\nresultsLong <- resultsHolder %>% map_df(bind_rows, .id = 'iter')\n\n# Summary information for results\nresultsLongSum <- resultsLong %>% \n  filter(round == 6) %>%\n  group_by(Winner) %>% \n  summarise(n = n(), seed = unique(WinnerSeed))\n\n# Tournament champion histogram\nggplot(resultsLongSum, aes(reorder(Winner, -1*n), n)) +\n  geom_bar(stat = 'identity') +\n  labs(x = 'Tournament Champion', \n       y = 'Wins',\n       caption = '\"Play in #\" teams were not available at time of simulation') +\n  theme_minimal() +\n  theme(axis.text.x = element_text(angle = 45, hjust = 1))\n```\n\n::: {.cell-output-display}\n![](post-Simulating-2018-NCAA-March-Madness-Tournament-Performance-in-R_files/figure-html/unnamed-chunk-46-1.png){fig-align='center' width=672}\n:::\n:::\n\n\nAnd it looks like this simulation predicted Xavier to win most often!\n\n# Conclusion\n\nOf course, much more goes into tournament performance than seed placement and historical win probabilities. At the time that we first wrote this, a #16 seed had never beaten a #1 seed in the first round. Models using purely historical data (such as Nick's) were unable to account for #16 seed UMBC's historical first round victory over #1 seed Virginia in this year's NCAA Men's tournament. Nevertheless, this was a super fun exercise in R and thinking about modeling tournament style performance. Hope you enjoyed this post and any feedback is always welcome!\n\n# Acknowledgments\n\nA huge thanks to my friends Nick Ray, David Hoagey, Linh Lazarus, Giuseppe Miranda, and [Ekarin Pongpipat](https://epongpipat.github.io/CV.html) for their enthusiasm and help with this blog post. They helped turn a small idea into an awesome collaboration where we got to share thoughts, work off each other's ideas, and learn more about R!\n",
    "supporting": [
      "post-Simulating-2018-NCAA-March-Madness-Tournament-Performance-in-R_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<script src=\"../../site_libs/kePrint-0.0.1/kePrint.js\"></script>\n<link href=\"../../site_libs/lightable-0.0.1/lightable.css\" rel=\"stylesheet\" />\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}