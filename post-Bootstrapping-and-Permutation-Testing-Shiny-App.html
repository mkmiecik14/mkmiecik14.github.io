<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="Matthew J. Kmiecik &amp; Ekarin E. Pongpipat" />

<meta name="date" content="2018-06-07" />

<title>Bootstrapping and Permutation Testing: A Shiny App</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/flatly.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/accessible-code-block-0.0.1/empty-anchor.js"></script>
<link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />
<!-- Google Analytics -->
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-104506183-1', 'auto');
  ga('send', 'pageview');

</script>

<!-- Twittercards -->
<meta name="twitter:card" content="summary" />

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  { color: #cccccc; background-color: #303030; }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ffcfaf; } /* Alert */
code span.an { color: #7f9f7f; font-weight: bold; } /* Annotation */
code span.at { } /* Attribute */
code span.bn { color: #dca3a3; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #f0dfaf; } /* ControlFlow */
code span.ch { color: #dca3a3; } /* Char */
code span.cn { color: #dca3a3; font-weight: bold; } /* Constant */
code span.co { color: #7f9f7f; } /* Comment */
code span.cv { color: #7f9f7f; font-weight: bold; } /* CommentVar */
code span.do { color: #7f9f7f; } /* Documentation */
code span.dt { color: #dfdfbf; } /* DataType */
code span.dv { color: #dcdccc; } /* DecVal */
code span.er { color: #c3bf9f; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #c0bed1; } /* Float */
code span.fu { color: #efef8f; } /* Function */
code span.im { } /* Import */
code span.in { color: #7f9f7f; font-weight: bold; } /* Information */
code span.kw { color: #f0dfaf; } /* Keyword */
code span.op { color: #f0efd0; } /* Operator */
code span.ot { color: #efef8f; } /* Other */
code span.pp { color: #ffcfaf; font-weight: bold; } /* Preprocessor */
code span.sc { color: #dca3a3; } /* SpecialChar */
code span.ss { color: #cc9393; } /* SpecialString */
code span.st { color: #cc9393; } /* String */
code span.va { } /* Variable */
code span.vs { color: #cc9393; } /* VerbatimString */
code span.wa { color: #7f9f7f; font-weight: bold; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>


<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>


<link rel="stylesheet" href="styles.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 60px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h2 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h3 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h4 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h5 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h6 {
  padding-top: 65px;
  margin-top: -65px;
}
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #ffffff;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row-fluid">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">



<div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">
        <i class="fas fa-chart-area logo-icon1" aria-hidden="true"></i> 
        <i class="far fa-chart-bar logo-icon2" aria-hidden="true"></i> 
        <i class="fas fa-chart-line logo-icon3" aria-hidden="true"></i> Matthew J. Kmiecik, PhD</a> <!-- You can put words here for nav -->
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav navbar-right">
        <li>
          <a href="index.html">
            <i class="fas fa-home" aria-hidden="true"></i> Home</a>
        </li>
        <li>
          <a href="cv.html"><i class="fas fa-graduation-cap" aria-hidden="true"></i> CV</a>
        </li>
        <li class="dropdown">
          <a class="dropdown-toggle" data-toggle="dropdown" href="#">
            <i class="far fa-paper-plane" aria-hidden="true"></i> My Blogs<span class="caret"></span>
          </a>
          <ul class="dropdown-menu">
            <li><a href="academicblog.html">Academic</a></li>
            <li><a href="theblueline.html">The Blue Line</a></li>
          </ul>
        </li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.3.1/css/all.css" integrity="sha384-mzrmE5qonljUremFsqc01SB46JvROS7bZs3IO2EmfFsd15uHvIt+Y8vEf7N7fWAU" crossorigin="anonymous">
<script defer src="https://use.fontawesome.com/releases/v5.3.1/js/all.js" integrity="sha384-kW+oWsYx3YpxvjtZjFXqazFpA7UP/MbiY4jvs+RWZo2+N94PFZ36T6TFkc9O3qoB" crossorigin="anonymous"></script>
<link rel="stylesheet" href="academicons-1.8.0/css/academicons.css"/>
<link rel="stylesheet" href="font-awesome-animation.min.css"/>

<!-- Font Awesome CDNs


<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.4.0/css/font-awesome.min.css">


<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.2.0/css/all.css" integrity="sha384-hWVjflwFxL6sNzntih27bfxkr27PmbbK/iSvJ+a4+0owXq79v+lsFkW54bOGbiDQ" crossorigin="anonymous">

<link href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-wvfXpqpZZVQGK6TAh5PVlGOfQNHSoD2xbE+QkPxCAFlNEevoEH3Sl0sibVcOQVnN" crossorigin="anonymous"/>

-->

<div class="fluid-row" id="header">



<h1 class="title toc-ignore">Bootstrapping and Permutation Testing: A Shiny App</h1>
<h4 class="author">Matthew J. Kmiecik &amp; Ekarin E. Pongpipat</h4>
<h4 class="date">7 June 2018</h4>

</div>


<p><br ></p>
<blockquote>
<p>We have since upgraded this shiny app to a shiny dashboard. <a href="https://mattkmiecik.shinyapps.io/boot-perm-dash/">Click here</a> to see it!</p>
</blockquote>
<div id="purpose" class="section level2">
<h2>Purpose</h2>
<hr >
<p>This post serves as a brief overview of the difference between bootstrapping and permutation testing with a shiny app to visualize their differences. The example statistic we use here is a correlation; however, these techniques can be extended to a variety of statistics (e.g., t-test, ANOVA, PCA).</p>
<p><br ></p>
</div>
<div id="shiny-app" class="section level2">
<h2>Shiny App</h2>
<hr >
<p>Here’s the shiny app used to illustrate these concepts. <a href="https://mattkmiecik.shinyapps.io/boot-perm-app/">Click here to see the app in full screen.</a></p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a>knitr<span class="op">::</span><span class="kw">include_app</span>(<span class="st">&quot;https://mattkmiecik.shinyapps.io/boot-perm-app/&quot;</span>, </span>
<span id="cb1-2"><a href="#cb1-2"></a>                   <span class="dt">height =</span> <span class="st">&quot;1400px&quot;</span>)</span></code></pre></div>
<iframe src="https://mattkmiecik.shinyapps.io/boot-perm-app/?showcase=0" width="672" height="1400px">
</iframe>
<p><br ></p>
<div id="bootstrapping" class="section level3">
<h3>Bootstrapping</h3>
<p>When you think of boostrapping, think confidence intervals. Bootstrapping <strong>samples observations with replacement</strong> without breaking the relationship between measures (e.g., X and Y). The number of samples is equal to the number of observations (i.e., sample size). After sampling with replacement is finished, the statistic of interest, such as a correlation, is computed and stored.</p>
<blockquote>
<p>When you think of boostrapping, think confidence intervals.</p>
</blockquote>
<p>This process explained above is then repeated hundreds or thousands of iterations resulting in a distribution of values for your statistic of interest. This distibution will be centered about the original statistical value that you computed before any resampling occured. In other words, the mean of these stored values will equal your observed statistic.</p>
<p>As with any distribution, you can calculate what are the lower bounds and upper bounds of values for a given percentage. This percentage is determined by the researcher/statistician/hockey analyst enthusiast and is called a confidence interval (95% is a common confidence interval). These bounds are usually reported in square brackets in the format: confidence interval % [lowerbound, upper bound]. For example, “There was a positive correlation observed between X and Y, <em>r</em> = .31, 95% CI [.21, .41].”</p>
<p><br ></p>
</div>
<div id="permutation-testing" class="section level3">
<h3>Permutation Testing</h3>
<p>When you think of permutation testing, think of p-values. Permutation testing <strong>does not sample observations with replacement, but instead breaks the relationship between measures (e.g., X and Y).</strong> This is done by shuffling/randomizing/sampling the observed data points for one variable, while keeping the other (or others) intact. In terms of correlation, this would mean that X would be shuffled within the sample, while Y remained the original values. After the responses for one variable are randomized the statistic of interest, such as a correlation, is computed and stored.</p>
<blockquote>
<p>When you think of permutation testing, think of p-values.</p>
</blockquote>
<p>This process explained above is then repeated hundreds or thousands of iterations resulting in a distribution of values for your statistic of interest. This distibution <strong>will not be centered about the original statistic value that you computed before any shuffling occured, but rather will be centered around the null.</strong> In terms of correlation, a null distribution would center about <em>r</em> = 0; meaning no linear relationship between variables.</p>
<p>In other words, a null distribution is created by shuffling the values in X but not Y. This is because the relationship has been broken between X and Y.</p>
<p>A p-value is calculated by first counting the number of statistical values that are more extreme than your observed statistic. Put another way, how many times did the statistical value that emerged from a “null distribution” surpass your original computed statistic (before any shuffling). Then, you take the number of times that the null distribution is more extreme than your original value and divide it by the number of permutation iterations (number of observations in your null distribution).</p>
<p>For example, let’s say I ran a permutation test on a correlation of <em>r</em> = .5 and shuffled X, kept Y, computed their correlation, stored this value, and repeated this 100 times. Out of 100 times, there were 4 correlations that emerged that were greater than .5. Therefore, my p-value for this correlation would be 4/100 = 0.04.</p>
<p><br ></p>
</div>
</div>
<div id="shiny-app-code" class="section level2">
<h2>Shiny App Code</h2>
<hr >
<p>Below is the code that runs the shiny app:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a><span class="co"># Packages required ----</span></span>
<span id="cb2-2"><a href="#cb2-2"></a><span class="kw">library</span>(shiny) </span>
<span id="cb2-3"><a href="#cb2-3"></a><span class="kw">library</span>(dplyr)</span>
<span id="cb2-4"><a href="#cb2-4"></a><span class="kw">library</span>(ggplot2)</span>
<span id="cb2-5"><a href="#cb2-5"></a><span class="kw">library</span>(tibble)</span>
<span id="cb2-6"><a href="#cb2-6"></a><span class="kw">library</span>(purrr)</span>
<span id="cb2-7"><a href="#cb2-7"></a><span class="kw">library</span>(broom)</span>
<span id="cb2-8"><a href="#cb2-8"></a><span class="kw">library</span>(MASS)</span>
<span id="cb2-9"><a href="#cb2-9"></a><span class="kw">library</span>(modelr)</span>
<span id="cb2-10"><a href="#cb2-10"></a><span class="kw">library</span>(shinythemes)</span>
<span id="cb2-11"><a href="#cb2-11"></a><span class="kw">library</span>(shinycssloaders)</span>
<span id="cb2-12"><a href="#cb2-12"></a></span>
<span id="cb2-13"><a href="#cb2-13"></a><span class="co"># Global aesthetics ----</span></span>
<span id="cb2-14"><a href="#cb2-14"></a></span>
<span id="cb2-15"><a href="#cb2-15"></a><span class="co"># Main color palette (Flatly bootstrap theme)</span></span>
<span id="cb2-16"><a href="#cb2-16"></a>flatlyPal &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&#39;#2C3E50&#39;</span>, <span class="st">&#39;#18BC9C&#39;</span>, <span class="st">&#39;#94A5A6&#39;</span>, <span class="st">&#39;#3498DC&#39;</span>, <span class="st">&#39;#F39C13&#39;</span>, <span class="st">&#39;#E74C3C&#39;</span>) </span>
<span id="cb2-17"><a href="#cb2-17"></a></span>
<span id="cb2-18"><a href="#cb2-18"></a><span class="co"># loading spinner options</span></span>
<span id="cb2-19"><a href="#cb2-19"></a><span class="kw">options</span>(<span class="dt">spinner.color =</span> flatlyPal[<span class="dv">1</span>], <span class="dt">spinner.type =</span> <span class="dv">8</span>)</span>
<span id="cb2-20"><a href="#cb2-20"></a></span>
<span id="cb2-21"><a href="#cb2-21"></a><span class="co"># Plot constant</span></span>
<span id="cb2-22"><a href="#cb2-22"></a>plotFinish &lt;-<span class="st"> </span><span class="kw">theme</span>(<span class="dt">plot.title =</span> <span class="kw">element_text</span>(<span class="dt">hjust =</span> <span class="fl">0.5</span>, <span class="dt">size =</span> <span class="dv">15</span>),</span>
<span id="cb2-23"><a href="#cb2-23"></a>                    <span class="dt">text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">15</span>),</span>
<span id="cb2-24"><a href="#cb2-24"></a>                    <span class="dt">plot.caption =</span> <span class="kw">element_text</span>(<span class="dt">hjust =</span> <span class="fl">.5</span>)</span>
<span id="cb2-25"><a href="#cb2-25"></a>                    )</span>
<span id="cb2-26"><a href="#cb2-26"></a></span>
<span id="cb2-27"><a href="#cb2-27"></a><span class="co"># Turning off scientific notation for p-values</span></span>
<span id="cb2-28"><a href="#cb2-28"></a><span class="kw">options</span>(<span class="dt">scipen =</span> <span class="dv">999</span>)</span>
<span id="cb2-29"><a href="#cb2-29"></a></span>
<span id="cb2-30"><a href="#cb2-30"></a><span class="co"># UI ----</span></span>
<span id="cb2-31"><a href="#cb2-31"></a></span>
<span id="cb2-32"><a href="#cb2-32"></a><span class="co"># Define UI for application that draws a histogram</span></span>
<span id="cb2-33"><a href="#cb2-33"></a>ui &lt;-<span class="st"> </span><span class="kw">fluidPage</span>(<span class="dt">theme =</span> <span class="kw">shinytheme</span>(<span class="st">&quot;flatly&quot;</span>),</span>
<span id="cb2-34"><a href="#cb2-34"></a>  </span>
<span id="cb2-35"><a href="#cb2-35"></a>  <span class="co"># Title</span></span>
<span id="cb2-36"><a href="#cb2-36"></a>  <span class="kw">h2</span>(<span class="st">&quot;Bootstrapping and Permutation Testing&quot;</span>),</span>
<span id="cb2-37"><a href="#cb2-37"></a>  </span>
<span id="cb2-38"><a href="#cb2-38"></a>  <span class="co"># Author info</span></span>
<span id="cb2-39"><a href="#cb2-39"></a>  <span class="kw">h4</span>(<span class="st">&quot;Matthew J. Kmiecik &amp; Ekarin E. Pongpipat&quot;</span>),</span>
<span id="cb2-40"><a href="#cb2-40"></a>  </span>
<span id="cb2-41"><a href="#cb2-41"></a>  <span class="co"># Blogpost info</span></span>
<span id="cb2-42"><a href="#cb2-42"></a>  <span class="kw">p</span>(<span class="st">&quot;See our &quot;</span>, </span>
<span id="cb2-43"><a href="#cb2-43"></a>    <span class="kw">a</span>(<span class="st">&quot;blog post&quot;</span>, <span class="dt">href=</span><span class="st">&quot;https://mattkmiecik.com/post-Bootstrapping-and-Permutation-Testing-Shiny-App.html&quot;</span>), </span>
<span id="cb2-44"><a href="#cb2-44"></a>    <span class="st">&quot;for more information about this shiny app.&quot;</span></span>
<span id="cb2-45"><a href="#cb2-45"></a>    ),</span>
<span id="cb2-46"><a href="#cb2-46"></a>  </span>
<span id="cb2-47"><a href="#cb2-47"></a>  <span class="co"># Sidebar with a slider input for number of bins </span></span>
<span id="cb2-48"><a href="#cb2-48"></a>  <span class="kw">sidebarLayout</span>(</span>
<span id="cb2-49"><a href="#cb2-49"></a>    <span class="kw">sidebarPanel</span>(</span>
<span id="cb2-50"><a href="#cb2-50"></a>      <span class="kw">sliderInput</span>(<span class="dt">inputId =</span> <span class="st">&quot;rUser&quot;</span>,</span>
<span id="cb2-51"><a href="#cb2-51"></a>                  <span class="dt">label =</span> <span class="st">&quot;Correlation (r): &quot;</span>,</span>
<span id="cb2-52"><a href="#cb2-52"></a>                  <span class="dt">min =</span> <span class="dv">-1</span>,</span>
<span id="cb2-53"><a href="#cb2-53"></a>                  <span class="dt">max =</span> <span class="dv">1</span>,</span>
<span id="cb2-54"><a href="#cb2-54"></a>                  <span class="dt">value =</span> <span class="fl">.3</span>,</span>
<span id="cb2-55"><a href="#cb2-55"></a>                  <span class="dt">step =</span> <span class="fl">.1</span>,</span>
<span id="cb2-56"><a href="#cb2-56"></a>                  <span class="dt">ticks =</span> <span class="ot">FALSE</span>),</span>
<span id="cb2-57"><a href="#cb2-57"></a>      <span class="kw">sliderInput</span>(<span class="dt">inputId =</span> <span class="st">&quot;sampleN&quot;</span>,</span>
<span id="cb2-58"><a href="#cb2-58"></a>                  <span class="dt">label =</span> <span class="st">&quot;Sample size (N): &quot;</span>,</span>
<span id="cb2-59"><a href="#cb2-59"></a>                  <span class="dt">min =</span> <span class="dv">10</span>,</span>
<span id="cb2-60"><a href="#cb2-60"></a>                  <span class="dt">max =</span> <span class="dv">200</span>,</span>
<span id="cb2-61"><a href="#cb2-61"></a>                  <span class="dt">value =</span> <span class="dv">50</span>,</span>
<span id="cb2-62"><a href="#cb2-62"></a>                  <span class="dt">step =</span> <span class="dv">10</span>,</span>
<span id="cb2-63"><a href="#cb2-63"></a>                  <span class="dt">ticks =</span> <span class="ot">FALSE</span>),</span>
<span id="cb2-64"><a href="#cb2-64"></a>      <span class="kw">sliderInput</span>(<span class="dt">inputId =</span> <span class="st">&quot;bootIters&quot;</span>,</span>
<span id="cb2-65"><a href="#cb2-65"></a>                  <span class="dt">label =</span> <span class="st">&quot;Bootstrap Iterations: &quot;</span>,</span>
<span id="cb2-66"><a href="#cb2-66"></a>                  <span class="dt">min =</span> <span class="dv">100</span>,</span>
<span id="cb2-67"><a href="#cb2-67"></a>                  <span class="dt">max =</span> <span class="dv">2000</span>,</span>
<span id="cb2-68"><a href="#cb2-68"></a>                  <span class="dt">value =</span> <span class="dv">100</span>,</span>
<span id="cb2-69"><a href="#cb2-69"></a>                  <span class="dt">step =</span> <span class="dv">100</span>,</span>
<span id="cb2-70"><a href="#cb2-70"></a>                  <span class="dt">ticks =</span> <span class="ot">FALSE</span>),</span>
<span id="cb2-71"><a href="#cb2-71"></a>      <span class="kw">sliderInput</span>(<span class="dt">inputId =</span> <span class="st">&quot;ciUser&quot;</span>,</span>
<span id="cb2-72"><a href="#cb2-72"></a>                  <span class="dt">label =</span> <span class="st">&quot;Bootstrap Confidence Interval: &quot;</span>,</span>
<span id="cb2-73"><a href="#cb2-73"></a>                  <span class="dt">min =</span> <span class="fl">.80</span>,</span>
<span id="cb2-74"><a href="#cb2-74"></a>                  <span class="dt">max =</span> <span class="fl">.99</span>,</span>
<span id="cb2-75"><a href="#cb2-75"></a>                  <span class="dt">value =</span> <span class="fl">.90</span>,</span>
<span id="cb2-76"><a href="#cb2-76"></a>                  <span class="dt">step =</span> <span class="fl">.01</span>,</span>
<span id="cb2-77"><a href="#cb2-77"></a>                  <span class="dt">ticks =</span> <span class="ot">FALSE</span>),</span>
<span id="cb2-78"><a href="#cb2-78"></a>      <span class="kw">sliderInput</span>(<span class="dt">inputId =</span> <span class="st">&quot;permIters&quot;</span>,</span>
<span id="cb2-79"><a href="#cb2-79"></a>                  <span class="dt">label =</span> <span class="st">&quot;Permutation Iterations: &quot;</span>,</span>
<span id="cb2-80"><a href="#cb2-80"></a>                  <span class="dt">min =</span> <span class="dv">100</span>,</span>
<span id="cb2-81"><a href="#cb2-81"></a>                  <span class="dt">max =</span> <span class="dv">2000</span>,</span>
<span id="cb2-82"><a href="#cb2-82"></a>                  <span class="dt">value =</span> <span class="dv">100</span>,</span>
<span id="cb2-83"><a href="#cb2-83"></a>                  <span class="dt">step =</span> <span class="dv">100</span>,</span>
<span id="cb2-84"><a href="#cb2-84"></a>                  <span class="dt">ticks =</span> <span class="ot">FALSE</span>), </span>
<span id="cb2-85"><a href="#cb2-85"></a>      <span class="dt">width =</span> <span class="st">&quot;2&quot;</span>),</span>
<span id="cb2-86"><a href="#cb2-86"></a>    </span>
<span id="cb2-87"><a href="#cb2-87"></a>    <span class="co"># Plots</span></span>
<span id="cb2-88"><a href="#cb2-88"></a>    <span class="kw">mainPanel</span>(</span>
<span id="cb2-89"><a href="#cb2-89"></a>      <span class="kw">flowLayout</span>(</span>
<span id="cb2-90"><a href="#cb2-90"></a>        <span class="kw">plotOutput</span>(<span class="st">&quot;scatterPlot&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">withSpinner</span>(),</span>
<span id="cb2-91"><a href="#cb2-91"></a>        <span class="kw">plotOutput</span>(<span class="st">&quot;bootPlot&quot;</span>)  <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">withSpinner</span>(),</span>
<span id="cb2-92"><a href="#cb2-92"></a>        <span class="kw">plotOutput</span>(<span class="st">&quot;permPlot&quot;</span>)  <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">withSpinner</span>()</span>
<span id="cb2-93"><a href="#cb2-93"></a>      )</span>
<span id="cb2-94"><a href="#cb2-94"></a>    )</span>
<span id="cb2-95"><a href="#cb2-95"></a>  )</span>
<span id="cb2-96"><a href="#cb2-96"></a>)</span>
<span id="cb2-97"><a href="#cb2-97"></a></span>
<span id="cb2-98"><a href="#cb2-98"></a><span class="co"># Server ----</span></span>
<span id="cb2-99"><a href="#cb2-99"></a>server &lt;-<span class="st"> </span><span class="cf">function</span>(input, output) {</span>
<span id="cb2-100"><a href="#cb2-100"></a></span>
<span id="cb2-101"><a href="#cb2-101"></a>  <span class="co"># Defined variables</span></span>
<span id="cb2-102"><a href="#cb2-102"></a>  vars    &lt;-<span class="st"> </span><span class="dv">2</span> <span class="co"># Minimum of 2 variables are required for correlation</span></span>
<span id="cb2-103"><a href="#cb2-103"></a>  mu &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="dv">0</span>, vars) <span class="co"># Means of all the vars are 0</span></span>
<span id="cb2-104"><a href="#cb2-104"></a>  </span>
<span id="cb2-105"><a href="#cb2-105"></a>  <span class="co"># Calculates sigma</span></span>
<span id="cb2-106"><a href="#cb2-106"></a>  re_sigma &lt;-<span class="st"> </span><span class="kw">reactive</span>({<span class="kw">matrix</span>(input<span class="op">$</span>rUser, <span class="dt">nrow =</span> vars, <span class="dt">ncol =</span> vars)})</span>
<span id="cb2-107"><a href="#cb2-107"></a>  </span>
<span id="cb2-108"><a href="#cb2-108"></a>  <span class="co"># Establihses sigma = 1</span></span>
<span id="cb2-109"><a href="#cb2-109"></a>  re_sigma2 &lt;-<span class="st"> </span><span class="kw">reactive</span>({<span class="kw">re_sigma</span>() <span class="op">-</span><span class="st"> </span><span class="kw">diag</span>(vars)<span class="op">*</span>(input<span class="op">$</span>rUser) <span class="op">+</span><span class="st"> </span><span class="kw">diag</span>(vars)}) </span>
<span id="cb2-110"><a href="#cb2-110"></a>  </span>
<span id="cb2-111"><a href="#cb2-111"></a>  <span class="co"># Gathers correlations</span></span>
<span id="cb2-112"><a href="#cb2-112"></a>  re_rawvars &lt;-<span class="st"> </span><span class="kw">reactive</span>({<span class="kw">as.tibble</span>(<span class="kw">mvrnorm</span>(<span class="dt">n =</span> input<span class="op">$</span>sampleN, </span>
<span id="cb2-113"><a href="#cb2-113"></a>                                            <span class="dt">mu =</span> mu, </span>
<span id="cb2-114"><a href="#cb2-114"></a>                                            <span class="dt">Sigma =</span> <span class="kw">re_sigma2</span>(), </span>
<span id="cb2-115"><a href="#cb2-115"></a>                                            <span class="dt">empirical =</span> T</span>
<span id="cb2-116"><a href="#cb2-116"></a>                                            )</span>
<span id="cb2-117"><a href="#cb2-117"></a>                                    ) <span class="op">%&gt;%</span></span>
<span id="cb2-118"><a href="#cb2-118"></a><span class="st">      </span><span class="kw">rename</span>(<span class="dt">x =</span> V1, <span class="dt">y =</span> V2)}</span>
<span id="cb2-119"><a href="#cb2-119"></a>      )</span>
<span id="cb2-120"><a href="#cb2-120"></a>  </span>
<span id="cb2-121"><a href="#cb2-121"></a>  <span class="co"># Bootstrapping procedure ----</span></span>
<span id="cb2-122"><a href="#cb2-122"></a>  re_bootResults &lt;-<span class="st"> </span><span class="kw">reactive</span>({<span class="kw">re_rawvars</span>() <span class="op">%&gt;%</span></span>
<span id="cb2-123"><a href="#cb2-123"></a><span class="st">    </span>broom<span class="op">::</span><span class="kw">bootstrap</span>(input<span class="op">$</span>bootIters) <span class="op">%&gt;%</span></span>
<span id="cb2-124"><a href="#cb2-124"></a><span class="st">    </span><span class="kw">do</span>(<span class="kw">tidy</span>(<span class="kw">lm</span>(<span class="kw">scale</span>(y) <span class="op">~</span><span class="st"> </span><span class="kw">scale</span>(x), .))) <span class="op">%&gt;%</span></span>
<span id="cb2-125"><a href="#cb2-125"></a><span class="st">    </span><span class="kw">filter</span>(term <span class="op">!=</span><span class="st"> &#39;(Intercept)&#39;</span>)})</span>
<span id="cb2-126"><a href="#cb2-126"></a>   </span>
<span id="cb2-127"><a href="#cb2-127"></a>  <span class="co"># Confidence interval calculations ----</span></span>
<span id="cb2-128"><a href="#cb2-128"></a>  re_ciUserL &lt;-<span class="st"> </span><span class="kw">reactive</span>({(<span class="dv">1</span><span class="op">-</span>input<span class="op">$</span>ciUser)<span class="op">/</span><span class="dv">2</span>})</span>
<span id="cb2-129"><a href="#cb2-129"></a>  re_ciUserU &lt;-<span class="st"> </span><span class="kw">reactive</span>({input<span class="op">$</span>ciUser <span class="op">+</span><span class="st"> </span><span class="kw">re_ciUserL</span>()})</span>
<span id="cb2-130"><a href="#cb2-130"></a>  re_ciObs &lt;-<span class="st"> </span><span class="kw">reactive</span>({<span class="kw">quantile</span>(<span class="kw">re_bootResults</span>()<span class="op">$</span>estimate, </span>
<span id="cb2-131"><a href="#cb2-131"></a>                                 <span class="kw">c</span>(<span class="kw">re_ciUserL</span>(), <span class="kw">re_ciUserU</span>()))})</span>
<span id="cb2-132"><a href="#cb2-132"></a></span>
<span id="cb2-133"><a href="#cb2-133"></a>  <span class="co"># Permutation testing procedure ----</span></span>
<span id="cb2-134"><a href="#cb2-134"></a>  <span class="co"># From: https://www.rdocumentation.org/packages/modelr/versions/0.1.1/topics/permute</span></span>
<span id="cb2-135"><a href="#cb2-135"></a>  re_perms &lt;-<span class="st"> </span><span class="kw">reactive</span>({<span class="kw">re_rawvars</span>() <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">permute</span>(input<span class="op">$</span>permIters, y)})</span>
<span id="cb2-136"><a href="#cb2-136"></a>  re_models &lt;-<span class="st"> </span><span class="kw">reactive</span>({<span class="kw">map</span>(<span class="kw">re_perms</span>()[[<span class="st">&quot;perm&quot;</span>]], </span>
<span id="cb2-137"><a href="#cb2-137"></a>                             <span class="op">~</span><span class="st"> </span><span class="kw">lm</span>(<span class="kw">scale</span>(y) <span class="op">~</span><span class="st"> </span><span class="kw">scale</span>(x), <span class="dt">data =</span> .))})</span>
<span id="cb2-138"><a href="#cb2-138"></a>  re_tidyd &lt;-<span class="st"> </span><span class="kw">reactive</span>({<span class="kw">map_df</span>(<span class="kw">re_models</span>(), broom<span class="op">::</span>tidy, <span class="dt">.id =</span> <span class="st">&#39;id&#39;</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb2-139"><a href="#cb2-139"></a><span class="st">      </span><span class="kw">filter</span>(term <span class="op">!=</span><span class="st"> &#39;(Intercept)&#39;</span>)})</span>
<span id="cb2-140"><a href="#cb2-140"></a>  </span>
<span id="cb2-141"><a href="#cb2-141"></a>  <span class="co"># Calculates p value from permutation testing</span></span>
<span id="cb2-142"><a href="#cb2-142"></a>  re_permPVal &lt;-<span class="st"> </span><span class="kw">reactive</span>({</span>
<span id="cb2-143"><a href="#cb2-143"></a>    <span class="cf">if</span> (input<span class="op">$</span>rUser <span class="op">&gt;=</span><span class="st"> </span><span class="dv">0</span>) {</span>
<span id="cb2-144"><a href="#cb2-144"></a>      (<span class="kw">sum</span>(<span class="kw">re_tidyd</span>()[[<span class="st">&quot;estimate&quot;</span>]] <span class="op">&gt;=</span><span class="st"> </span>input<span class="op">$</span>rUser) <span class="op">+</span><span class="st"> </span><span class="dv">1</span>)<span class="op">/</span>input<span class="op">$</span>permIters</span>
<span id="cb2-145"><a href="#cb2-145"></a>    } <span class="cf">else</span> <span class="cf">if</span> ( input<span class="op">$</span>rUser <span class="op">&lt;</span><span class="st"> </span><span class="dv">0</span> ) {</span>
<span id="cb2-146"><a href="#cb2-146"></a>      (<span class="kw">sum</span>(<span class="kw">re_tidyd</span>()[[<span class="st">&quot;estimate&quot;</span>]] <span class="op">&lt;=</span><span class="st"> </span>input<span class="op">$</span>rUser) <span class="op">+</span><span class="st"> </span><span class="dv">1</span>)<span class="op">/</span>input<span class="op">$</span>permIters</span>
<span id="cb2-147"><a href="#cb2-147"></a>    }</span>
<span id="cb2-148"><a href="#cb2-148"></a>  }</span>
<span id="cb2-149"><a href="#cb2-149"></a>  )</span>
<span id="cb2-150"><a href="#cb2-150"></a>    </span>
<span id="cb2-151"><a href="#cb2-151"></a>  <span class="co"># Scatterplot ----</span></span>
<span id="cb2-152"><a href="#cb2-152"></a>  </span>
<span id="cb2-153"><a href="#cb2-153"></a>   output<span class="op">$</span>scatterPlot &lt;-<span class="st"> </span><span class="kw">renderPlot</span>({</span>
<span id="cb2-154"><a href="#cb2-154"></a>     </span>
<span id="cb2-155"><a href="#cb2-155"></a>     <span class="co"># Caption for Scatterplot</span></span>
<span id="cb2-156"><a href="#cb2-156"></a>     corResP &lt;-<span class="st"> </span><span class="kw">round</span>(<span class="kw">cor.test</span>(<span class="kw">re_rawvars</span>()<span class="op">$</span>x, <span class="kw">re_rawvars</span>()<span class="op">$</span>y)<span class="op">$</span>p.value, <span class="dv">3</span>)</span>
<span id="cb2-157"><a href="#cb2-157"></a>     corResPFinal &lt;-<span class="st"> </span><span class="kw">ifelse</span>(corResP <span class="op">&gt;</span><span class="st"> </span><span class="fl">.001</span>, corResP, <span class="fl">.001</span>)</span>
<span id="cb2-158"><a href="#cb2-158"></a>     pSign &lt;-<span class="st"> </span><span class="kw">ifelse</span>(corResP <span class="op">&gt;</span><span class="st"> </span><span class="fl">.001</span>, <span class="st">&#39;= &#39;</span>, <span class="st">&#39;&lt; &#39;</span>)</span>
<span id="cb2-159"><a href="#cb2-159"></a>     scatRes &lt;-<span class="st"> </span><span class="kw">paste0</span>(<span class="st">&#39;r (&#39;</span>, input<span class="op">$</span>sampleN<span class="dv">-2</span>, <span class="st">&#39;) = &#39;</span>, input<span class="op">$</span>rUser,</span>
<span id="cb2-160"><a href="#cb2-160"></a>                       <span class="st">&#39;, p &#39;</span>, pSign,corResPFinal)</span>
<span id="cb2-161"><a href="#cb2-161"></a>     </span>
<span id="cb2-162"><a href="#cb2-162"></a>     <span class="co"># Plot</span></span>
<span id="cb2-163"><a href="#cb2-163"></a>     <span class="kw">ggplot</span>(<span class="kw">re_rawvars</span>(), <span class="kw">aes</span>(x, y)) <span class="op">+</span></span>
<span id="cb2-164"><a href="#cb2-164"></a><span class="st">       </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&#39;lm&#39;</span>, <span class="dt">se =</span> T, </span>
<span id="cb2-165"><a href="#cb2-165"></a>                   <span class="dt">color =</span> flatlyPal[<span class="dv">6</span>], <span class="dt">fill =</span> flatlyPal[<span class="dv">3</span>]) <span class="op">+</span></span>
<span id="cb2-166"><a href="#cb2-166"></a><span class="st">       </span><span class="kw">geom_point</span>(<span class="dt">color =</span> flatlyPal[<span class="dv">1</span>], <span class="dt">alpha =</span> <span class="dv">2</span><span class="op">/</span><span class="dv">3</span>) <span class="op">+</span></span>
<span id="cb2-167"><a href="#cb2-167"></a><span class="st">       </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&#39;X&#39;</span>, <span class="dt">y =</span> <span class="st">&#39;Y&#39;</span>, </span>
<span id="cb2-168"><a href="#cb2-168"></a>            <span class="dt">title =</span> <span class="st">&#39;Scatterplot&#39;</span>, <span class="dt">caption =</span> scatRes) <span class="op">+</span></span>
<span id="cb2-169"><a href="#cb2-169"></a><span class="st">       </span><span class="kw">theme_classic</span>() <span class="op">+</span></span>
<span id="cb2-170"><a href="#cb2-170"></a><span class="st">       </span>plotFinish</span>
<span id="cb2-171"><a href="#cb2-171"></a>     </span>
<span id="cb2-172"><a href="#cb2-172"></a>        })</span>
<span id="cb2-173"><a href="#cb2-173"></a></span>
<span id="cb2-174"><a href="#cb2-174"></a>  <span class="co"># Bootstrap Plot ----</span></span>
<span id="cb2-175"><a href="#cb2-175"></a>   output<span class="op">$</span>bootPlot &lt;-<span class="st"> </span><span class="kw">renderPlot</span>({</span>
<span id="cb2-176"><a href="#cb2-176"></a>     <span class="kw">ggplot</span>(<span class="kw">re_bootResults</span>(), <span class="kw">aes</span>(estimate)) <span class="op">+</span></span>
<span id="cb2-177"><a href="#cb2-177"></a><span class="st">       </span><span class="kw">geom_histogram</span>(<span class="dt">binwidth =</span> <span class="fl">.05</span>, <span class="dt">fill =</span> flatlyPal[<span class="dv">1</span>]) <span class="op">+</span></span>
<span id="cb2-178"><a href="#cb2-178"></a><span class="st">       </span><span class="kw">geom_errorbarh</span>(<span class="kw">aes</span>(<span class="dt">xmin =</span> <span class="kw">re_ciObs</span>()[[<span class="dv">1</span>]], <span class="dt">xmax =</span> <span class="kw">re_ciObs</span>()[[<span class="dv">2</span>]], </span>
<span id="cb2-179"><a href="#cb2-179"></a>                          <span class="dt">x =</span> input<span class="op">$</span>rUser, <span class="dt">y =</span> <span class="kw">nrow</span>(<span class="kw">re_bootResults</span>())<span class="op">/</span><span class="dv">10</span>), </span>
<span id="cb2-180"><a href="#cb2-180"></a>                      <span class="dt">height =</span> <span class="dv">0</span>, <span class="dt">color =</span> flatlyPal[<span class="dv">2</span>], <span class="dt">size =</span> <span class="dv">1</span>) <span class="op">+</span></span>
<span id="cb2-181"><a href="#cb2-181"></a><span class="st">       </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">x =</span> input<span class="op">$</span>rUser, <span class="dt">y =</span> <span class="kw">nrow</span>(<span class="kw">re_bootResults</span>())<span class="op">/</span><span class="dv">10</span>),</span>
<span id="cb2-182"><a href="#cb2-182"></a>                  <span class="dt">size =</span> <span class="dv">4</span>, <span class="dt">color =</span> flatlyPal[<span class="dv">2</span>]) <span class="op">+</span></span>
<span id="cb2-183"><a href="#cb2-183"></a><span class="st">       </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&#39;Correlation&#39;</span>, <span class="dt">y =</span> <span class="st">&#39;Frequency&#39;</span>, </span>
<span id="cb2-184"><a href="#cb2-184"></a>            <span class="dt">title =</span> <span class="st">&#39;Bootstrapping&#39;</span>, </span>
<span id="cb2-185"><a href="#cb2-185"></a>            <span class="dt">caption =</span> <span class="kw">paste0</span>(input<span class="op">$</span>ciUser<span class="op">*</span><span class="dv">100</span>, <span class="st">&#39;% CI [&#39;</span>, </span>
<span id="cb2-186"><a href="#cb2-186"></a>                             <span class="kw">round</span>(<span class="kw">re_ciObs</span>()[[<span class="dv">1</span>]], <span class="dv">2</span>), <span class="st">&#39;, &#39;</span>,</span>
<span id="cb2-187"><a href="#cb2-187"></a>                             <span class="kw">round</span>(<span class="kw">re_ciObs</span>()[[<span class="dv">2</span>]], <span class="dv">2</span>), <span class="st">&#39;]&#39;</span>)</span>
<span id="cb2-188"><a href="#cb2-188"></a>            ) <span class="op">+</span></span>
<span id="cb2-189"><a href="#cb2-189"></a><span class="st">       </span><span class="kw">theme_classic</span>() <span class="op">+</span></span>
<span id="cb2-190"><a href="#cb2-190"></a><span class="st">       </span>plotFinish</span>
<span id="cb2-191"><a href="#cb2-191"></a>   })</span>
<span id="cb2-192"><a href="#cb2-192"></a>   </span>
<span id="cb2-193"><a href="#cb2-193"></a>   <span class="co"># Permutation plot ----</span></span>
<span id="cb2-194"><a href="#cb2-194"></a>   output<span class="op">$</span>permPlot &lt;-<span class="st"> </span><span class="kw">renderPlot</span>({</span>
<span id="cb2-195"><a href="#cb2-195"></a>     <span class="kw">ggplot</span>(<span class="kw">re_tidyd</span>(), <span class="kw">aes</span>(estimate)) <span class="op">+</span></span>
<span id="cb2-196"><a href="#cb2-196"></a><span class="st">       </span><span class="kw">geom_histogram</span>(<span class="dt">binwidth =</span> <span class="fl">.05</span>, <span class="dt">fill =</span> flatlyPal[<span class="dv">1</span>]) <span class="op">+</span></span>
<span id="cb2-197"><a href="#cb2-197"></a><span class="st">       </span><span class="kw">geom_vline</span>(<span class="kw">aes</span>(<span class="dt">xintercept =</span> input<span class="op">$</span>rUser), </span>
<span id="cb2-198"><a href="#cb2-198"></a>                  <span class="dt">color =</span> flatlyPal[<span class="dv">6</span>], <span class="dt">linetype =</span> <span class="dv">2</span>, <span class="dt">size =</span> <span class="fl">.75</span>) <span class="op">+</span></span>
<span id="cb2-199"><a href="#cb2-199"></a><span class="st">       </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&#39;Correlation&#39;</span>, <span class="dt">y =</span> <span class="st">&#39;Frequency&#39;</span>, </span>
<span id="cb2-200"><a href="#cb2-200"></a>            <span class="dt">title =</span> <span class="st">&#39;Permutation Testing&#39;</span>,</span>
<span id="cb2-201"><a href="#cb2-201"></a>            <span class="dt">caption =</span> <span class="kw">paste0</span>(<span class="st">&#39;r = &#39;</span>, input<span class="op">$</span>rUser, <span class="st">&#39;, p = &#39;</span>, <span class="kw">round</span>(<span class="kw">re_permPVal</span>(), <span class="dv">5</span>))</span>
<span id="cb2-202"><a href="#cb2-202"></a>            ) <span class="op">+</span></span>
<span id="cb2-203"><a href="#cb2-203"></a><span class="st">       </span><span class="kw">theme_classic</span>() <span class="op">+</span></span>
<span id="cb2-204"><a href="#cb2-204"></a><span class="st">       </span>plotFinish</span>
<span id="cb2-205"><a href="#cb2-205"></a>     </span>
<span id="cb2-206"><a href="#cb2-206"></a>   })</span>
<span id="cb2-207"><a href="#cb2-207"></a>}</span>
<span id="cb2-208"><a href="#cb2-208"></a></span>
<span id="cb2-209"><a href="#cb2-209"></a><span class="co"># Application ----</span></span>
<span id="cb2-210"><a href="#cb2-210"></a><span class="kw">shinyApp</span>(<span class="dt">ui =</span> ui, <span class="dt">server =</span> server)</span></code></pre></div>
<p><br ></p>
</div>
<div id="references" class="section level2">
<h2>References</h2>
<hr >
<p>Readers who would like more theoretical or technical explanations of boostrapping and permutation testing are encouraged to read:</p>
<ul>
<li><p>Efron, B. (1979). Bootstrap methods: Another look at the jacknife. <em>The Annals of Statistics, 7</em>(1), 1-26.</p></li>
<li><p>Ludbrook, J., &amp; Dudley, H. (1998). Why Permutation Tests are Superior to t and F Tests in Biomedical Research. <em>The American Statistician, 52</em>(2), 127-132. <a href="doi:10.1080/00031305.1998.10480551" class="uri">doi:10.1080/00031305.1998.10480551</a></p></li>
<li><p>Wright, D. B., London, K., &amp; Field, A. P. (2018). Using Bootstrap Estimation and the Plug-in Principle for Clinical Psychology Data. <em>Journal of Experimental Psychopathology, 2</em>(2). <a href="doi:10.5127/jep.013611" class="uri">doi:10.5127/jep.013611</a></p></li>
</ul>
<!-- disqus START -->
<div id="disqus_thread">

</div>
<script>
/**
*  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
*  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables*/
/*
var disqus_config = function () {
this.page.url = 'https://mattkmiecik.com/post-Bootstrapping-and-Permutation-Testing-Shiny-App';  // Replace PAGE_URL with your page's canonical URL variable
this.page.identifier = 'post-Bootstrapping-and-Permutation-Testing-Shiny-App'; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
};
*/
(function() { // DON'T EDIT BELOW THIS LINE
var d = document, s = d.createElement('script');
s.src = 'https://mattkmiecik.disqus.com/embed.js';
s.setAttribute('data-timestamp', +new Date());
(d.head || d.body).appendChild(s);
})();
</script>
<noscript>
Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a>
</noscript>
<!-- disqus END -->
</div>

</div> <!-- articleBandContent -->
</div> <!-- pageContent -->
</div> <!-- forPagesWithTOC -->

<footer class="footer">
  <div class="container">
    <span class="text-muted">&copy; 2022 Matthew J. Kmiecik. All rights reserved.</span>
  </div>
</footer>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->

<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
