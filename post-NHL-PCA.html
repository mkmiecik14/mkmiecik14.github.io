<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />


<meta name="author" content="Matthew J. Kmiecik &amp; Ekarin E. Pongpipat" />


<title>NHL PCA</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/flatly.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/kePrint-0.0.1/kePrint.js"></script>
<!-- Google Analytics -->
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-104506183-1', 'auto');
  ga('send', 'pageview');

</script>

<!-- Twittercards -->
<meta name="twitter:card" content="summary" />


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; background-color: #303030; color: #cccccc; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; }
td.sourceCode { padding-left: 5px; }
pre, code { color: #cccccc; background-color: #303030; }
code > span.kw { color: #f0dfaf; } /* Keyword */
code > span.dt { color: #dfdfbf; } /* DataType */
code > span.dv { color: #dcdccc; } /* DecVal */
code > span.bn { color: #dca3a3; } /* BaseN */
code > span.fl { color: #c0bed1; } /* Float */
code > span.ch { color: #dca3a3; } /* Char */
code > span.st { color: #cc9393; } /* String */
code > span.co { color: #7f9f7f; } /* Comment */
code > span.ot { color: #efef8f; } /* Other */
code > span.al { color: #ffcfaf; } /* Alert */
code > span.fu { color: #efef8f; } /* Function */
code > span.er { color: #c3bf9f; } /* Error */
code > span.wa { color: #7f9f7f; font-weight: bold; } /* Warning */
code > span.cn { color: #dca3a3; font-weight: bold; } /* Constant */
code > span.sc { color: #dca3a3; } /* SpecialChar */
code > span.vs { color: #cc9393; } /* VerbatimString */
code > span.ss { color: #cc9393; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { } /* Variable */
code > span.cf { color: #f0dfaf; } /* ControlFlow */
code > span.op { color: #f0efd0; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #ffcfaf; font-weight: bold; } /* Preprocessor */
code > span.at { } /* Attribute */
code > span.do { color: #7f9f7f; } /* Documentation */
code > span.an { color: #7f9f7f; font-weight: bold; } /* Annotation */
code > span.cv { color: #7f9f7f; font-weight: bold; } /* CommentVar */
code > span.in { color: #7f9f7f; font-weight: bold; } /* Information */
</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>


<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>

<link rel="stylesheet" href="styles.css" type="text/css" />

</head>

<body>

<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 60px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 65px;
  margin-top: -65px;
}

.section h2 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h3 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h4 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h5 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h6 {
  padding-top: 65px;
  margin-top: -65px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>


<div class="container-fluid main-container">

<!-- tabsets -->
<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});
</script>

<!-- code folding -->




<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_').toLowerCase();
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}


.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
  padding-left: 25px;
  text-indent: 0;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>

<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row-fluid">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">



<div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">
        <i class="fas fa-chart-area logo-icon1" aria-hidden="true"></i> 
        <i class="far fa-chart-bar logo-icon2" aria-hidden="true"></i> 
        <i class="fas fa-chart-line logo-icon3" aria-hidden="true"></i> Matthew J. Kmiecik</a> <!-- You can put words here for nav -->
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav navbar-right">
        <li>
          <a href="index.html">
            <i class="fas fa-home" aria-hidden="true"></i> Home</a>
        </li>
        <li>
          <a href="cv.html"><i class="fas fa-graduation-cap" aria-hidden="true"></i> CV</a>
        </li>
        <li class="dropdown">
          <a class="dropdown-toggle" data-toggle="dropdown" href="#">
            <i class="far fa-paper-plane" aria-hidden="true"></i> My Blogs<span class="caret"></span>
          </a>
          <ul class="dropdown-menu">
            <li><a href="academicblog.html">Academic</a></li>
            <li><a href="theblueline.html">The Blue Line</a></li>
          </ul>
        </li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.3.1/css/all.css" integrity="sha384-mzrmE5qonljUremFsqc01SB46JvROS7bZs3IO2EmfFsd15uHvIt+Y8vEf7N7fWAU" crossorigin="anonymous">
<script defer src="https://use.fontawesome.com/releases/v5.3.1/js/all.js" integrity="sha384-kW+oWsYx3YpxvjtZjFXqazFpA7UP/MbiY4jvs+RWZo2+N94PFZ36T6TFkc9O3qoB" crossorigin="anonymous"></script>
<link rel="stylesheet" href="academicons-1.8.0/css/academicons.css"/>
<link rel="stylesheet" href="font-awesome-animation.min.css"/>

<!-- Font Awesome CDNs


<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.4.0/css/font-awesome.min.css">


<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.2.0/css/all.css" integrity="sha384-hWVjflwFxL6sNzntih27bfxkr27PmbbK/iSvJ+a4+0owXq79v+lsFkW54bOGbiDQ" crossorigin="anonymous">

<link href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-wvfXpqpZZVQGK6TAh5PVlGOfQNHSoD2xbE+QkPxCAFlNEevoEH3Sl0sibVcOQVnN" crossorigin="anonymous"/>

-->

<div class="fluid-row" id="header">



<h1 class="title toc-ignore">NHL PCA</h1>
<h4 class="author"><em>Matthew J. Kmiecik &amp; Ekarin E. Pongpipat</em></h4>
<h4 class="date"><em>date here</em></h4>

</div>


<div id="setup" class="section level2">
<h2>Setup</h2>
<hr >
<p>Here are the packages that we’ll use for these analyses and to style the output/plots.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Packages ----</span>
<span class="kw">library</span>(tidyverse)    <span class="co"># For data manipulation, plotting, etc. </span>
<span class="kw">library</span>(RCurl)        <span class="co"># To import data on github</span>
<span class="kw">library</span>(TInPosition)  <span class="co"># PCA tools</span>
<span class="kw">library</span>(ggrepel)      <span class="co"># Plotting tool for ggplot2</span>
<span class="kw">library</span>(kableExtra)   <span class="co"># HTML table tools</span>
<span class="kw">library</span>(RColorBrewer) <span class="co"># Nice plotting colors</span>

<span class="co"># Custom functions ----</span>
<span class="co"># nice_table() simplifies the printing of HTML tables using kable</span>
nice_table &lt;-<span class="st"> </span><span class="cf">function</span>(x){
  
  <span class="kw">kable</span>(x) <span class="op">%&gt;%</span>
<span class="st">    </span><span class="kw">kable_styling</span>(<span class="dt">bootstrap_options =</span> <span class="kw">c</span>(<span class="st">&#39;striped&#39;</span>, <span class="st">&#39;hover&#39;</span>, <span class="st">&#39;responsive&#39;</span>))
  
}

<span class="co"># Color palettes ----</span>
rdgy &lt;-<span class="st"> </span><span class="kw">brewer.pal</span>(<span class="dt">n =</span> <span class="dv">11</span>, <span class="dt">name =</span> <span class="st">&quot;RdGy&quot;</span>) <span class="co"># display.brewer.pal(11, &quot;RdGy&quot;)</span></code></pre></div>
<p>Let’s first prepare the data for analysis. These data were downloaded from <a href="http://corsica.hockey/">Corsica’s</a> team stats tool. We’ve prepared these data for you and are available for import into R like this:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Link to raw data on Github</span>
link &lt;-<span class="st"> &quot;https://raw.githubusercontent.com/mkmiecik14/mkmiecik14.github.io/master/data/nhl-team-data-corsica.csv&quot;</span>

<span class="co"># reads in data from Github</span>
nhl_data &lt;-<span class="st"> </span><span class="kw">read_csv</span>(<span class="dt">file =</span> <span class="kw">getURL</span>(link))</code></pre></div>
<p>To make things as simple as possible, without losing information, we’ll use Chicago Blackhawk’s data from the 2007-2008 season up through the 2017-2018 season (11 years of data) and only a subset of the available metrics. These include:</p>
<ul>
<li>Games Played (GP)</li>
<li>Time on Ice (TOI)</li>
<li>Corsi For (CF) = Shot attempts for at even strength: Shots + Blocks + Misses</li>
<li>Corsi Against (CA) = Shot attempts against at even strength: Shots + Blocks + Misses</li>
<li>Goals For (GF)</li>
<li>Goals Against (GA)</li>
<li>Pentaly minutes served (PENT)</li>
<li>Penalty minutes drawn (PEND)</li>
<li>Shooting Percentage (ShootPerc)</li>
<li>Save Percentage (SavePerc)</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Preparing Hawks data ----</span>
hawks_data &lt;-<span class="st">  </span>nhl_data <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">select</span>(Team<span class="op">:</span>CA, GF, GA, PENT, PEND, <span class="dt">ShootPerc =</span> <span class="st">`</span><span class="dt">Sh%</span><span class="st">`</span>, <span class="dt">SavePerc =</span> <span class="st">`</span><span class="dt">Sv%</span><span class="st">`</span>) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">filter</span>(Team <span class="op">==</span><span class="st"> &quot;CHI&quot;</span>) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">separate</span>(Season, <span class="dt">into =</span> <span class="kw">c</span>(<span class="st">&quot;Start_Year&quot;</span>, <span class="st">&quot;Season&quot;</span>)) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">Team =</span> <span class="ot">NULL</span>, 
         <span class="dt">Start_Year =</span> <span class="ot">NULL</span>,
         <span class="dt">Season =</span> <span class="kw">as.numeric</span>(Season)
         )

<span class="co"># Prints data</span>
<span class="kw">nice_table</span>(hawks_data)</code></pre></div>
<table class="table table-striped table-hover table-responsive" style="margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:right;">
Season
</th>
<th style="text-align:right;">
GP
</th>
<th style="text-align:right;">
TOI
</th>
<th style="text-align:right;">
CF
</th>
<th style="text-align:right;">
CA
</th>
<th style="text-align:right;">
GF
</th>
<th style="text-align:right;">
GA
</th>
<th style="text-align:right;">
PENT
</th>
<th style="text-align:right;">
PEND
</th>
<th style="text-align:right;">
ShootPerc
</th>
<th style="text-align:right;">
SavePerc
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
2008
</td>
<td style="text-align:right;">
80
</td>
<td style="text-align:right;">
3423.00
</td>
<td style="text-align:right;">
2600
</td>
<td style="text-align:right;">
2629
</td>
<td style="text-align:right;">
143
</td>
<td style="text-align:right;">
130
</td>
<td style="text-align:right;">
368
</td>
<td style="text-align:right;">
365
</td>
<td style="text-align:right;">
9.04
</td>
<td style="text-align:right;">
91.92
</td>
</tr>
<tr>
<td style="text-align:right;">
2009
</td>
<td style="text-align:right;">
82
</td>
<td style="text-align:right;">
3646.73
</td>
<td style="text-align:right;">
3286
</td>
<td style="text-align:right;">
2655
</td>
<td style="text-align:right;">
146
</td>
<td style="text-align:right;">
124
</td>
<td style="text-align:right;">
335
</td>
<td style="text-align:right;">
368
</td>
<td style="text-align:right;">
7.45
</td>
<td style="text-align:right;">
92.42
</td>
</tr>
<tr>
<td style="text-align:right;">
2010
</td>
<td style="text-align:right;">
82
</td>
<td style="text-align:right;">
3881.33
</td>
<td style="text-align:right;">
3784
</td>
<td style="text-align:right;">
2907
</td>
<td style="text-align:right;">
178
</td>
<td style="text-align:right;">
147
</td>
<td style="text-align:right;">
276
</td>
<td style="text-align:right;">
299
</td>
<td style="text-align:right;">
8.30
</td>
<td style="text-align:right;">
90.53
</td>
</tr>
<tr>
<td style="text-align:right;">
2011
</td>
<td style="text-align:right;">
82
</td>
<td style="text-align:right;">
3955.85
</td>
<td style="text-align:right;">
3704
</td>
<td style="text-align:right;">
3314
</td>
<td style="text-align:right;">
167
</td>
<td style="text-align:right;">
144
</td>
<td style="text-align:right;">
239
</td>
<td style="text-align:right;">
277
</td>
<td style="text-align:right;">
8.06
</td>
<td style="text-align:right;">
92.03
</td>
</tr>
<tr>
<td style="text-align:right;">
2012
</td>
<td style="text-align:right;">
82
</td>
<td style="text-align:right;">
3944.77
</td>
<td style="text-align:right;">
3698
</td>
<td style="text-align:right;">
3290
</td>
<td style="text-align:right;">
166
</td>
<td style="text-align:right;">
164
</td>
<td style="text-align:right;">
270
</td>
<td style="text-align:right;">
287
</td>
<td style="text-align:right;">
8.15
</td>
<td style="text-align:right;">
90.99
</td>
</tr>
<tr>
<td style="text-align:right;">
2013
</td>
<td style="text-align:right;">
48
</td>
<td style="text-align:right;">
2300.80
</td>
<td style="text-align:right;">
2103
</td>
<td style="text-align:right;">
1783
</td>
<td style="text-align:right;">
105
</td>
<td style="text-align:right;">
68
</td>
<td style="text-align:right;">
151
</td>
<td style="text-align:right;">
159
</td>
<td style="text-align:right;">
8.97
</td>
<td style="text-align:right;">
92.94
</td>
</tr>
<tr>
<td style="text-align:right;">
2014
</td>
<td style="text-align:right;">
82
</td>
<td style="text-align:right;">
3979.35
</td>
<td style="text-align:right;">
3890
</td>
<td style="text-align:right;">
3129
</td>
<td style="text-align:right;">
182
</td>
<td style="text-align:right;">
149
</td>
<td style="text-align:right;">
244
</td>
<td style="text-align:right;">
231
</td>
<td style="text-align:right;">
8.44
</td>
<td style="text-align:right;">
91.39
</td>
</tr>
<tr>
<td style="text-align:right;">
2015
</td>
<td style="text-align:right;">
82
</td>
<td style="text-align:right;">
3980.10
</td>
<td style="text-align:right;">
4003
</td>
<td style="text-align:right;">
3462
</td>
<td style="text-align:right;">
150
</td>
<td style="text-align:right;">
128
</td>
<td style="text-align:right;">
225
</td>
<td style="text-align:right;">
248
</td>
<td style="text-align:right;">
6.87
</td>
<td style="text-align:right;">
93.54
</td>
</tr>
<tr>
<td style="text-align:right;">
2016
</td>
<td style="text-align:right;">
82
</td>
<td style="text-align:right;">
3985.37
</td>
<td style="text-align:right;">
3680
</td>
<td style="text-align:right;">
3585
</td>
<td style="text-align:right;">
135
</td>
<td style="text-align:right;">
141
</td>
<td style="text-align:right;">
216
</td>
<td style="text-align:right;">
234
</td>
<td style="text-align:right;">
6.81
</td>
<td style="text-align:right;">
92.81
</td>
</tr>
<tr>
<td style="text-align:right;">
2017
</td>
<td style="text-align:right;">
82
</td>
<td style="text-align:right;">
4053.47
</td>
<td style="text-align:right;">
3759
</td>
<td style="text-align:right;">
3692
</td>
<td style="text-align:right;">
164
</td>
<td style="text-align:right;">
136
</td>
<td style="text-align:right;">
206
</td>
<td style="text-align:right;">
222
</td>
<td style="text-align:right;">
8.17
</td>
<td style="text-align:right;">
93.31
</td>
</tr>
<tr>
<td style="text-align:right;">
2018
</td>
<td style="text-align:right;">
82
</td>
<td style="text-align:right;">
3940.41
</td>
<td style="text-align:right;">
4199
</td>
<td style="text-align:right;">
3821
</td>
<td style="text-align:right;">
156
</td>
<td style="text-align:right;">
173
</td>
<td style="text-align:right;">
214
</td>
<td style="text-align:right;">
261
</td>
<td style="text-align:right;">
7.08
</td>
<td style="text-align:right;">
91.82
</td>
</tr>
</tbody>
</table>
<p>Let’s also prepare a table of notable events of every year in this data set for the Chicago Blackhawks, including their Stanley Cup wins (3) and their playoff success:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Initializing Chicago Blackhawks notable events table ----</span>
<span class="co"># SCW = Stanley Cup Wins</span>
<span class="co"># PF = Playoff Finish:</span>
<span class="co">#   0 = Did not make playoffs</span>
<span class="co">#   1 = Lost in first round</span>
<span class="co">#   2 = Lost in second round</span>
<span class="co">#   3 = Lost in conference finals</span>
<span class="co">#   4 = Lost in Stanley Cup final</span>
<span class="co">#   5 = Won Stanley Cup</span>
hawks_events &lt;-<span class="st"> </span><span class="kw">tibble</span>(<span class="dt">Season =</span> hawks_data<span class="op">$</span>Season,
                       <span class="dt">SCW =</span> <span class="kw">factor</span>(<span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>)),
                       <span class="dt">PF  =</span> <span class="kw">factor</span>(<span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">5</span>, <span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>))
                       )</code></pre></div>
<p>Prior to exploring these data and how they’ve changed over time, we have to:</p>
<ol style="list-style-type: decimal">
<li>Adjust all scores by the number of games played due to a shorted 2012-2013 season. We do this by dividing each metric by the number of games played.</li>
<li>Compute z-scores of all measures to facilitate comparisons</li>
</ol>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Preprocesses, adjusts, and z-scores hawks data ----</span>
hawks_data_long &lt;-<span class="st"> </span>hawks_data <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">gather</span>(Meas, Val, <span class="op">-</span>Season, <span class="op">-</span>GP) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">group_by</span>(Meas) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">Val_Adj =</span> Val<span class="op">/</span>GP,               <span class="co"># adjusts based on games played</span>
         <span class="dt">Val_Zscore =</span> <span class="kw">scale</span>(Val_Adj)     <span class="co"># computes z-scores</span>
         ) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">ungroup</span>() <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">sig =</span> <span class="kw">factor</span>(<span class="kw">ifelse</span>(<span class="kw">abs</span>(Val_Zscore) <span class="op">&gt;</span><span class="st"> </span><span class="fl">1.96</span>, <span class="st">&quot;p &lt; .05&quot;</span>, <span class="st">&quot;p &gt; .05&quot;</span>))) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># z score &gt; 1.96</span>
<span class="st">  </span><span class="kw">inner_join</span>(., hawks_events, <span class="dt">by =</span> <span class="st">&quot;Season&quot;</span>) <span class="co"># adds notable hawks events</span>

<span class="co"># Plots all measures together ----</span>
<span class="kw">ggplot</span>(hawks_data_long, <span class="kw">aes</span>(<span class="kw">factor</span>(Season), Val_Zscore)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_path</span>(<span class="kw">aes</span>(<span class="dt">group =</span> <span class="dv">1</span>), <span class="dt">color =</span> rdgy[<span class="dv">8</span>]) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">color =</span> sig, <span class="dt">shape =</span> SCW), <span class="dt">size =</span> <span class="fl">1.75</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_color_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(rdgy[<span class="dv">3</span>], rdgy[<span class="dv">10</span>]), <span class="dt">name =</span> <span class="st">&quot;Z-Score&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_shape_discrete</span>(<span class="dt">name =</span> <span class="st">&quot;Stanley Cup Wins&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">coord_cartesian</span>(<span class="dt">ylim =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">3</span>,<span class="dv">3</span>)) <span class="op">+</span>
<span class="st">  </span><span class="kw">theme_minimal</span>() <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Season&quot;</span>, 
       <span class="dt">y =</span> <span class="st">&quot;Measurement (Z-Score)&quot;</span>,
       <span class="dt">title =</span> <span class="st">&quot;Chicago Blackhawk&#39;s Performance 2007-2018&quot;</span>
       ) <span class="op">+</span>
<span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span>Meas, <span class="dt">nrow =</span> <span class="dv">3</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.text.x =</span> <span class="kw">element_text</span>(<span class="dt">angle =</span> <span class="dv">90</span>, <span class="dt">hjust =</span> <span class="dv">1</span>))</code></pre></div>
<p><img src="post-NHL-PCA_files/figure-html/unnamed-chunk-4-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>[small blurb here describing the z score plots]</p>
</div>
<div id="ekarins-version" class="section level2">
<h2>Ekarin’s version</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># adjust metric</span>
hawks_data_adj &lt;-<span class="st"> </span>hawks_data <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">rowwise</span>() <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">GP_adj =</span> TOI<span class="op">/</span>GP,
         <span class="dt">CF_adj =</span> CF<span class="op">/</span>GP,
         <span class="dt">GF_adj =</span> GF<span class="op">/</span>GP,
         <span class="dt">GA_adj =</span> GA<span class="op">/</span>GP,
         <span class="dt">PENT_adj =</span> PENT<span class="op">/</span>GP,
         <span class="dt">PEND_adj =</span> PEND<span class="op">/</span>GP,
         <span class="dt">ShootPerc_adj =</span> ShootPerc<span class="op">/</span>GP,
         <span class="dt">SavePerc_adj =</span> SavePerc<span class="op">/</span>GP) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">ungroup</span>() <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">select</span>(Season, <span class="kw">contains</span>(<span class="st">&quot;_adj&quot;</span>)) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">inner_join</span>(., hawks_events, <span class="dt">by =</span> <span class="st">&quot;Season&quot;</span>) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">apply</span>(., <span class="dv">2</span>, as.numeric) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">apply</span>(., <span class="dv">2</span>, scale)

<span class="co"># correlation matrix</span>
hawks_cor_mat &lt;-<span class="st"> </span><span class="kw">cor</span>(hawks_data_adj)

<span class="co"># convert to long format</span>
hawks_cor_long &lt;-<span class="st"> </span>hawks_cor_mat <span class="op">%&gt;%</span>
<span class="st">  </span>reshape2<span class="op">::</span><span class="kw">melt</span>() <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">arrange</span>(Var1, Var2)

<span class="co"># heatmap</span>
<span class="kw">ggplot</span>(hawks_cor_long, <span class="kw">aes</span>(<span class="dt">x =</span> Var1, <span class="dt">y =</span> Var2, <span class="dt">fill =</span> value)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_raster</span>() <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="kw">element_blank</span>(),
       <span class="dt">y =</span> <span class="kw">element_blank</span>(),
       <span class="dt">fill =</span> <span class="st">&quot;Correlation&quot;</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">theme_minimal</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.text.x =</span> <span class="kw">element_text</span>(<span class="dt">angle =</span> <span class="dv">45</span>, <span class="dt">hjust =</span> <span class="dv">1</span>)) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_fill_distiller</span>(<span class="dt">palette =</span> <span class="st">&quot;RdBu&quot;</span>, <span class="dt">limits =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">1</span>,<span class="dv">1</span>))</code></pre></div>
<p><img src="post-NHL-PCA_files/figure-html/unnamed-chunk-5-1.png" width="672" style="display: block; margin: auto;" /></p>
</div>
<div id="matts-version" class="section level2">
<h2>Matt’s version</h2>
<p>Now let’s examine how these measurements relate to each other by computing their correlations and visualizing them with a heatmap.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Converts back to wide format</span>
hawks_data_wide &lt;-<span class="st"> </span>hawks_data_long <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">select</span>(Season, Meas, Val_Zscore) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">spread</span>(Meas, Val_Zscore)

<span class="co"># Computes correlations</span>
hawks_cors &lt;-<span class="st"> </span><span class="kw">cor</span>(hawks_data_wide)

<span class="co"># Correlations to long format for plotting</span>
hawks_cors_long &lt;-<span class="st"> </span>hawks_cors <span class="op">%&gt;%</span>
<span class="st">  </span>reshape2<span class="op">::</span><span class="kw">melt</span>() <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">arrange</span>(Var1, Var2)

<span class="co"># Correlation heatmap</span>
<span class="kw">ggplot</span>(hawks_cors_long, <span class="kw">aes</span>(<span class="dt">x =</span> Var1, <span class="dt">y =</span> Var2, <span class="dt">fill =</span> value)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_raster</span>() <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">theme_minimal</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.text.x =</span> <span class="kw">element_text</span>(<span class="dt">angle =</span> <span class="dv">45</span>, <span class="dt">hjust =</span> <span class="dv">1</span>),
        <span class="dt">axis.title =</span> <span class="kw">element_blank</span>()
        ) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_fill_distiller</span>(<span class="dt">palette =</span> <span class="st">&quot;BrBG&quot;</span>, 
                       <span class="dt">limits =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">1</span>, <span class="dv">1</span>), 
                       <span class="dt">name =</span> <span class="st">&quot;Correlation&quot;</span>
                       )</code></pre></div>
<p><img src="post-NHL-PCA_files/figure-html/unnamed-chunk-6-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>[ a little blurb here about the patterns that emerge from the heatmap ]</p>
</div>
<div id="pca" class="section level2">
<h2>PCA</h2>
<p>We’ve explored these measures individually by plotting their change over time (2007-2018) as well as examining their correlations; however, it’s difficult to extract meaningful relationships between these variables, especially when there are a lot of variables to consider. Also, all realtionships between the variables are not considered simultaneously, but rather one at a time (e.g., bivariate correlations). Is there some way to analyze these variables’ relationships simultaneously, while also reducing their complexity?</p>
<p>One method of doing this is principal components analysis (PCA). PCA is often called a data reduction technique because it reduces the data structure into manageable “components” that explain proportions of variability in the data. In order to understand what each component means, we examine how information (e.g., years or measurements) is spread across the components.</p>
<p>Additionally, the PCA that we will demonstrate below places a constraint on the components such that they are orthogonal to each other, meaning that each component is perfectly uncorrelated with every other component (<em>r</em> = 0).</p>
<p>We go over the basics of PCA below, but we recommend the interested reader the following papers on this statistical technique:</p>
<ul>
<li><p>Abdi, H., &amp; Williams, L.J. (2010). <a href="https://www.utdallas.edu/~herve/abdi-awPCA2010.pdf">Principal component analysis</a>. <em>Wiley Interdisciplinary Reviews: Computational Statistics</em>, 2, 433-459.</p></li>
<li><p>Abdi, H. (2007). <a href="https://www.utdallas.edu/~herve/Abdi-SVD2007-pretty.pdf">Singular Value Decomposition (SVD) and Generalized Singular Value Decomposition (GSVD)</a>. In N.J. Salkind (Ed.): <em>Encyclopedia of Measurement and Statistics</em>. Thousand Oaks (CA): Sage. pp. 907-912.</p></li>
</ul>
<p>We first need to preprocess our data such that each column (e.g., measurement) has a mean of 0 and a standard deviation of 1. In other words, each column should be in z-score format. We’ve already done this above when exploring these data.</p>
<p>A unique feature of this dataset is the reduced 2012 - 2013 NHL season that we accounted for by scaling each column by the number of games played that season. We already did this above and do not need to repeat this step.</p>
<p>The first step is to convert these data into a matrix format with the season years on the rows as row names:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Converts to matrix</span>
hawks_data_mat &lt;-<span class="st"> </span>hawks_data_wide <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(<span class="op">-</span>Season) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">as.matrix</span>()
<span class="kw">rownames</span>(hawks_data_mat) &lt;-<span class="st"> </span>hawks_data_wide<span class="op">$</span>Season <span class="co"># Adds rownames</span>

<span class="kw">nice_table</span>(hawks_data_mat) <span class="co"># Prints HTML table</span></code></pre></div>
<table class="table table-striped table-hover table-responsive" style="margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
CA
</th>
<th style="text-align:right;">
CF
</th>
<th style="text-align:right;">
GA
</th>
<th style="text-align:right;">
GF
</th>
<th style="text-align:right;">
PEND
</th>
<th style="text-align:right;">
PENT
</th>
<th style="text-align:right;">
SavePerc
</th>
<th style="text-align:right;">
ShootPerc
</th>
<th style="text-align:right;">
TOI
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
2008
</td>
<td style="text-align:right;">
-1.3890061
</td>
<td style="text-align:right;">
-2.4688368
</td>
<td style="text-align:right;">
-0.4854171
</td>
<td style="text-align:right;">
-0.9263934
</td>
<td style="text-align:right;">
1.8463464
</td>
<td style="text-align:right;">
2.1908251
</td>
<td style="text-align:right;">
-0.2057746
</td>
<td style="text-align:right;">
0.3069261
</td>
<td style="text-align:right;">
-2.3384033
</td>
</tr>
<tr>
<td style="text-align:left;">
2009
</td>
<td style="text-align:right;">
-1.4909528
</td>
<td style="text-align:right;">
-0.9280729
</td>
<td style="text-align:right;">
-1.0362482
</td>
<td style="text-align:right;">
-0.9635667
</td>
<td style="text-align:right;">
1.7270345
</td>
<td style="text-align:right;">
1.4018816
</td>
<td style="text-align:right;">
-0.2953539
</td>
<td style="text-align:right;">
-0.4588701
</td>
<td style="text-align:right;">
-1.4947316
</td>
</tr>
<tr>
<td style="text-align:left;">
2010
</td>
<td style="text-align:right;">
-0.8442424
</td>
<td style="text-align:right;">
0.3075156
</td>
<td style="text-align:right;">
0.3333859
</td>
<td style="text-align:right;">
1.1052072
</td>
<td style="text-align:right;">
0.3829492
</td>
<td style="text-align:right;">
0.2988564
</td>
<td style="text-align:right;">
-0.3895168
</td>
<td style="text-align:right;">
-0.1004303
</td>
<td style="text-align:right;">
-0.0620987
</td>
</tr>
<tr>
<td style="text-align:left;">
2011
</td>
<td style="text-align:right;">
0.2002461
</td>
<td style="text-align:right;">
0.1090275
</td>
<td style="text-align:right;">
0.1547380
</td>
<td style="text-align:right;">
0.3940662
</td>
<td style="text-align:right;">
-0.0455997
</td>
<td style="text-align:right;">
-0.3928713
</td>
<td style="text-align:right;">
-0.3147844
</td>
<td style="text-align:right;">
-0.2016368
</td>
<td style="text-align:right;">
0.3929729
</td>
</tr>
<tr>
<td style="text-align:left;">
2012
</td>
<td style="text-align:right;">
0.1386547
</td>
<td style="text-align:right;">
0.0941409
</td>
<td style="text-align:right;">
1.3457241
</td>
<td style="text-align:right;">
0.3294170
</td>
<td style="text-align:right;">
0.1491952
</td>
<td style="text-align:right;">
0.1866843
</td>
<td style="text-align:right;">
-0.3665989
</td>
<td style="text-align:right;">
-0.1636844
</td>
<td style="text-align:right;">
0.3253106
</td>
</tr>
<tr>
<td style="text-align:left;">
2013
</td>
<td style="text-align:right;">
-0.4876321
</td>
<td style="text-align:right;">
-0.1673052
</td>
<td style="text-align:right;">
-1.5027177
</td>
<td style="text-align:right;">
1.1940998
</td>
<td style="text-align:right;">
-0.1503020
</td>
<td style="text-align:right;">
-0.0384388
</td>
<td style="text-align:right;">
3.0104356
</td>
<td style="text-align:right;">
2.8614429
</td>
<td style="text-align:right;">
0.2383715
</td>
</tr>
<tr>
<td style="text-align:left;">
2014
</td>
<td style="text-align:right;">
-0.2745214
</td>
<td style="text-align:right;">
0.5705123
</td>
<td style="text-align:right;">
0.4524845
</td>
<td style="text-align:right;">
1.3638039
</td>
<td style="text-align:right;">
-0.9416566
</td>
<td style="text-align:right;">
-0.2993946
</td>
<td style="text-align:right;">
-0.3466702
</td>
<td style="text-align:right;">
-0.0413931
</td>
<td style="text-align:right;">
0.5364805
</td>
</tr>
<tr>
<td style="text-align:left;">
2015
</td>
<td style="text-align:right;">
0.5800601
</td>
<td style="text-align:right;">
0.8508768
</td>
<td style="text-align:right;">
-0.7980509
</td>
<td style="text-align:right;">
-0.7049700
</td>
<td style="text-align:right;">
-0.6105051
</td>
<td style="text-align:right;">
-0.6546061
</td>
<td style="text-align:right;">
-0.2395537
</td>
<td style="text-align:right;">
-0.7034527
</td>
<td style="text-align:right;">
0.5410605
</td>
</tr>
<tr>
<td style="text-align:left;">
2016
</td>
<td style="text-align:right;">
0.8957164
</td>
<td style="text-align:right;">
0.0494811
</td>
<td style="text-align:right;">
-0.0239099
</td>
<td style="text-align:right;">
-1.6747077
</td>
<td style="text-align:right;">
-0.8832181
</td>
<td style="text-align:right;">
-0.8228642
</td>
<td style="text-align:right;">
-0.2759235
</td>
<td style="text-align:right;">
-0.7287543
</td>
<td style="text-align:right;">
0.5732428
</td>
</tr>
<tr>
<td style="text-align:left;">
2017
</td>
<td style="text-align:right;">
1.1703117
</td>
<td style="text-align:right;">
0.2454881
</td>
<td style="text-align:right;">
-0.3216565
</td>
<td style="text-align:right;">
0.2001186
</td>
<td style="text-align:right;">
-1.1169721
</td>
<td style="text-align:right;">
-1.0098176
</td>
<td style="text-align:right;">
-0.2510127
</td>
<td style="text-align:right;">
-0.1552505
</td>
<td style="text-align:right;">
0.9891094
</td>
</tr>
<tr>
<td style="text-align:left;">
2018
</td>
<td style="text-align:right;">
1.5013658
</td>
<td style="text-align:right;">
1.3371727
</td>
<td style="text-align:right;">
1.8816679
</td>
<td style="text-align:right;">
-0.3170749
</td>
<td style="text-align:right;">
-0.3572717
</td>
<td style="text-align:right;">
-0.8602549
</td>
<td style="text-align:right;">
-0.3252469
</td>
<td style="text-align:right;">
-0.6148969
</td>
<td style="text-align:right;">
0.2986854
</td>
</tr>
</tbody>
</table>
<p>Next we’ll decompose this matrix using a singular value decomposition (SVD), the mathematical procedure at the heart of PCA. A SVD will decompose our original matrix (X) into 3 separate matrices (U, , V). The original data matrix can be reconstructed via matrix multiplication/linear algebra of these 3 matrices:</p>
<p><font style="font-size: 14pt"> <span class="math display">\[
\mathbf{X = U \Delta V^T}
\]</span></p>
<p>Briefly, U contains information about the rows (e.g., years), V contains information about the columns (e.g., measures), and is a diagonal matrix of “weights” called singular values that are the square root of the eigen values.</p>
<p>Computing the SVD of our data matrix in R requires one line of code:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">hawks_data_svd &lt;-<span class="st"> </span><span class="kw">svd</span>(hawks_data_mat) <span class="co"># Singular value decomposition (SVD)</span></code></pre></div>
<div id="eigen-values" class="section level3">
<h3>Eigen Values</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">inertia &lt;-<span class="st"> </span><span class="kw">sum</span>(hawks_data_svd<span class="op">$</span>d<span class="op">^</span><span class="dv">2</span>) <span class="co"># Calculates inertia</span>

<span class="co"># Calculates values for the scree plot</span>
scree &lt;-<span class="st"> </span><span class="kw">tibble</span>(<span class="dt">eigs =</span> hawks_data_svd<span class="op">$</span>d<span class="op">^</span><span class="dv">2</span>, 
                <span class="dt">perc_explained =</span> (eigs<span class="op">/</span>inertia)<span class="op">*</span><span class="dv">100</span>,
                <span class="dt">comps =</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(eigs)
                )

<span class="kw">nice_table</span>(<span class="kw">round</span>(scree, <span class="dv">2</span>)) <span class="co"># prints HTML table</span></code></pre></div>
<table class="table table-striped table-hover table-responsive" style="margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:right;">
eigs
</th>
<th style="text-align:right;">
perc_explained
</th>
<th style="text-align:right;">
comps
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
47.40
</td>
<td style="text-align:right;">
52.66
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:right;">
25.16
</td>
<td style="text-align:right;">
27.95
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:right;">
10.02
</td>
<td style="text-align:right;">
11.14
</td>
<td style="text-align:right;">
3
</td>
</tr>
<tr>
<td style="text-align:right;">
4.43
</td>
<td style="text-align:right;">
4.92
</td>
<td style="text-align:right;">
4
</td>
</tr>
<tr>
<td style="text-align:right;">
2.02
</td>
<td style="text-align:right;">
2.24
</td>
<td style="text-align:right;">
5
</td>
</tr>
<tr>
<td style="text-align:right;">
0.53
</td>
<td style="text-align:right;">
0.59
</td>
<td style="text-align:right;">
6
</td>
</tr>
<tr>
<td style="text-align:right;">
0.37
</td>
<td style="text-align:right;">
0.41
</td>
<td style="text-align:right;">
7
</td>
</tr>
<tr>
<td style="text-align:right;">
0.08
</td>
<td style="text-align:right;">
0.09
</td>
<td style="text-align:right;">
8
</td>
</tr>
<tr>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
9
</td>
</tr>
</tbody>
</table>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Scree plot</span>
<span class="kw">ggplot</span>(scree, <span class="kw">aes</span>(<span class="kw">factor</span>(comps), eigs)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_path</span>(<span class="kw">aes</span>(<span class="dt">group =</span> <span class="dv">1</span>)) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">sec.axis =</span> <span class="kw">sec_axis</span>(<span class="op">~</span>.<span class="op">/</span>inertia <span class="op">*</span><span class="st"> </span><span class="dv">100</span>, 
                                         <span class="dt">name =</span> <span class="st">&quot;Percentage of Explained Variance&quot;</span>
                                         )
                     ) <span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Components&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;Eigenvalues&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">theme_minimal</span>()</code></pre></div>
<p><img src="post-NHL-PCA_files/figure-html/unnamed-chunk-9-1.png" width="672" style="display: block; margin: auto;" /></p>
</div>
<div id="row-wise-factor-scores" class="section level3">
<h3>Row-wise Factor Scores</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">svd_u &lt;-<span class="st"> </span>hawks_data_svd<span class="op">$</span>u
<span class="kw">round</span>(svd_u, <span class="dv">3</span>) <span class="op">%&gt;%</span><span class="st"> </span>nice_table</code></pre></div>
<table class="table table-striped table-hover table-responsive" style="margin-left: auto; margin-right: auto;">
<tbody>
<tr>
<td style="text-align:right;">
-0.670
</td>
<td style="text-align:right;">
0.198
</td>
<td style="text-align:right;">
-0.032
</td>
<td style="text-align:right;">
0.252
</td>
<td style="text-align:right;">
-0.413
</td>
<td style="text-align:right;">
-0.118
</td>
<td style="text-align:right;">
-0.305
</td>
<td style="text-align:right;">
-0.066
</td>
<td style="text-align:right;">
-0.195
</td>
</tr>
<tr>
<td style="text-align:right;">
-0.473
</td>
<td style="text-align:right;">
0.208
</td>
<td style="text-align:right;">
-0.128
</td>
<td style="text-align:right;">
-0.238
</td>
<td style="text-align:right;">
0.466
</td>
<td style="text-align:right;">
-0.013
</td>
<td style="text-align:right;">
0.139
</td>
<td style="text-align:right;">
0.066
</td>
<td style="text-align:right;">
0.456
</td>
</tr>
<tr>
<td style="text-align:right;">
-0.046
</td>
<td style="text-align:right;">
-0.010
</td>
<td style="text-align:right;">
0.445
</td>
<td style="text-align:right;">
-0.290
</td>
<td style="text-align:right;">
0.187
</td>
<td style="text-align:right;">
0.030
</td>
<td style="text-align:right;">
0.096
</td>
<td style="text-align:right;">
0.201
</td>
<td style="text-align:right;">
-0.696
</td>
</tr>
<tr>
<td style="text-align:right;">
0.089
</td>
<td style="text-align:right;">
0.019
</td>
<td style="text-align:right;">
0.092
</td>
<td style="text-align:right;">
-0.114
</td>
<td style="text-align:right;">
-0.099
</td>
<td style="text-align:right;">
-0.313
</td>
<td style="text-align:right;">
0.404
</td>
<td style="text-align:right;">
0.484
</td>
<td style="text-align:right;">
0.191
</td>
</tr>
<tr>
<td style="text-align:right;">
0.070
</td>
<td style="text-align:right;">
0.115
</td>
<td style="text-align:right;">
0.345
</td>
<td style="text-align:right;">
0.271
</td>
<td style="text-align:right;">
-0.118
</td>
<td style="text-align:right;">
0.241
</td>
<td style="text-align:right;">
0.532
</td>
<td style="text-align:right;">
-0.575
</td>
<td style="text-align:right;">
0.114
</td>
</tr>
<tr>
<td style="text-align:right;">
-0.135
</td>
<td style="text-align:right;">
-0.890
</td>
<td style="text-align:right;">
-0.141
</td>
<td style="text-align:right;">
0.241
</td>
<td style="text-align:right;">
0.130
</td>
<td style="text-align:right;">
0.058
</td>
<td style="text-align:right;">
0.020
</td>
<td style="text-align:right;">
0.010
</td>
<td style="text-align:right;">
0.008
</td>
</tr>
<tr>
<td style="text-align:right;">
0.168
</td>
<td style="text-align:right;">
-0.096
</td>
<td style="text-align:right;">
0.384
</td>
<td style="text-align:right;">
-0.350
</td>
<td style="text-align:right;">
-0.222
</td>
<td style="text-align:right;">
0.369
</td>
<td style="text-align:right;">
-0.515
</td>
<td style="text-align:right;">
0.026
</td>
<td style="text-align:right;">
0.384
</td>
</tr>
<tr>
<td style="text-align:right;">
0.181
</td>
<td style="text-align:right;">
0.075
</td>
<td style="text-align:right;">
-0.377
</td>
<td style="text-align:right;">
-0.324
</td>
<td style="text-align:right;">
0.333
</td>
<td style="text-align:right;">
-0.093
</td>
<td style="text-align:right;">
-0.182
</td>
<td style="text-align:right;">
-0.495
</td>
<td style="text-align:right;">
-0.215
</td>
</tr>
<tr>
<td style="text-align:right;">
0.194
</td>
<td style="text-align:right;">
0.207
</td>
<td style="text-align:right;">
-0.531
</td>
<td style="text-align:right;">
0.114
</td>
<td style="text-align:right;">
-0.172
</td>
<td style="text-align:right;">
0.594
</td>
<td style="text-align:right;">
0.121
</td>
<td style="text-align:right;">
0.322
</td>
<td style="text-align:right;">
-0.149
</td>
</tr>
<tr>
<td style="text-align:right;">
0.279
</td>
<td style="text-align:right;">
-0.052
</td>
<td style="text-align:right;">
-0.207
</td>
<td style="text-align:right;">
-0.178
</td>
<td style="text-align:right;">
-0.460
</td>
<td style="text-align:right;">
-0.525
</td>
<td style="text-align:right;">
0.033
</td>
<td style="text-align:right;">
-0.120
</td>
<td style="text-align:right;">
0.046
</td>
</tr>
<tr>
<td style="text-align:right;">
0.343
</td>
<td style="text-align:right;">
0.227
</td>
<td style="text-align:right;">
0.151
</td>
<td style="text-align:right;">
0.616
</td>
<td style="text-align:right;">
0.368
</td>
<td style="text-align:right;">
-0.230
</td>
<td style="text-align:right;">
-0.344
</td>
<td style="text-align:right;">
0.147
</td>
<td style="text-align:right;">
0.056
</td>
</tr>
</tbody>
</table>
</div>
<div id="column-wise-factor-scores" class="section level3">
<h3>Column-wise Factor Scores</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">svd_v &lt;-<span class="st"> </span>hawks_data_svd<span class="op">$</span>v
<span class="kw">round</span>(svd_v, <span class="dv">3</span>) <span class="op">%&gt;%</span><span class="st"> </span>nice_table</code></pre></div>
<table class="table table-striped table-hover table-responsive" style="margin-left: auto; margin-right: auto;">
<tbody>
<tr>
<td style="text-align:right;">
0.413
</td>
<td style="text-align:right;">
0.082
</td>
<td style="text-align:right;">
-0.259
</td>
<td style="text-align:right;">
0.415
</td>
<td style="text-align:right;">
-0.187
</td>
<td style="text-align:right;">
-0.662
</td>
<td style="text-align:right;">
-0.088
</td>
<td style="text-align:right;">
-0.307
</td>
<td style="text-align:right;">
0.089
</td>
</tr>
<tr>
<td style="text-align:right;">
0.422
</td>
<td style="text-align:right;">
-0.043
</td>
<td style="text-align:right;">
0.134
</td>
<td style="text-align:right;">
-0.098
</td>
<td style="text-align:right;">
0.794
</td>
<td style="text-align:right;">
0.022
</td>
<td style="text-align:right;">
-0.250
</td>
<td style="text-align:right;">
-0.215
</td>
<td style="text-align:right;">
-0.229
</td>
</tr>
<tr>
<td style="text-align:right;">
0.231
</td>
<td style="text-align:right;">
0.302
</td>
<td style="text-align:right;">
0.577
</td>
<td style="text-align:right;">
0.631
</td>
<td style="text-align:right;">
-0.079
</td>
<td style="text-align:right;">
0.321
</td>
<td style="text-align:right;">
0.058
</td>
<td style="text-align:right;">
0.106
</td>
<td style="text-align:right;">
0.032
</td>
</tr>
<tr>
<td style="text-align:right;">
0.094
</td>
<td style="text-align:right;">
-0.404
</td>
<td style="text-align:right;">
0.700
</td>
<td style="text-align:right;">
-0.315
</td>
<td style="text-align:right;">
-0.168
</td>
<td style="text-align:right;">
-0.384
</td>
<td style="text-align:right;">
-0.082
</td>
<td style="text-align:right;">
0.024
</td>
<td style="text-align:right;">
0.238
</td>
</tr>
<tr>
<td style="text-align:right;">
-0.424
</td>
<td style="text-align:right;">
0.142
</td>
<td style="text-align:right;">
0.150
</td>
<td style="text-align:right;">
0.170
</td>
<td style="text-align:right;">
0.438
</td>
<td style="text-align:right;">
-0.460
</td>
<td style="text-align:right;">
0.575
</td>
<td style="text-align:right;">
0.115
</td>
<td style="text-align:right;">
-0.053
</td>
</tr>
<tr>
<td style="text-align:right;">
-0.445
</td>
<td style="text-align:right;">
0.087
</td>
<td style="text-align:right;">
0.179
</td>
<td style="text-align:right;">
0.043
</td>
<td style="text-align:right;">
-0.032
</td>
<td style="text-align:right;">
0.120
</td>
<td style="text-align:right;">
-0.112
</td>
<td style="text-align:right;">
-0.853
</td>
<td style="text-align:right;">
0.073
</td>
</tr>
<tr>
<td style="text-align:right;">
-0.073
</td>
<td style="text-align:right;">
-0.584
</td>
<td style="text-align:right;">
-0.191
</td>
<td style="text-align:right;">
0.382
</td>
<td style="text-align:right;">
0.269
</td>
<td style="text-align:right;">
0.188
</td>
<td style="text-align:right;">
0.023
</td>
<td style="text-align:right;">
0.023
</td>
<td style="text-align:right;">
0.603
</td>
</tr>
<tr>
<td style="text-align:right;">
-0.135
</td>
<td style="text-align:right;">
-0.585
</td>
<td style="text-align:right;">
0.032
</td>
<td style="text-align:right;">
0.328
</td>
<td style="text-align:right;">
-0.142
</td>
<td style="text-align:right;">
-0.007
</td>
<td style="text-align:right;">
-0.019
</td>
<td style="text-align:right;">
-0.021
</td>
<td style="text-align:right;">
-0.714
</td>
</tr>
<tr>
<td style="text-align:right;">
0.433
</td>
<td style="text-align:right;">
-0.163
</td>
<td style="text-align:right;">
-0.035
</td>
<td style="text-align:right;">
-0.192
</td>
<td style="text-align:right;">
-0.121
</td>
<td style="text-align:right;">
0.224
</td>
<td style="text-align:right;">
0.759
</td>
<td style="text-align:right;">
-0.326
</td>
<td style="text-align:right;">
-0.028
</td>
</tr>
</tbody>
</table>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">nhl_data_mat &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(nhl_data[,<span class="dv">2</span><span class="op">:</span><span class="kw">ncol</span>(nhl_data)])
<span class="kw">rownames</span>(nhl_data_mat) &lt;-<span class="st"> </span>nhl_data<span class="op">$</span>Season

nhl_data_mat_scaled &lt;-<span class="st"> </span><span class="kw">apply</span>(nhl_data_mat, <span class="dv">2</span>, scale)

nhl_data_svd &lt;-<span class="st"> </span><span class="kw">svd</span>(nhl_data_mat_scaled)

rows &lt;-<span class="st"> </span>nhl_data_svd<span class="op">$</span>u <span class="op">%*%</span><span class="st"> </span><span class="kw">diag</span>(nhl_data_svd<span class="op">$</span>d)
columns &lt;-<span class="st"> </span>nhl_data_svd<span class="op">$</span>v <span class="op">%*%</span><span class="st"> </span><span class="kw">diag</span>(nhl_data_svd<span class="op">$</span>d)


fis &lt;-<span class="st"> </span><span class="kw">as.tibble</span>(rows) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">Season =</span> nhl_data<span class="op">$</span>Season,
         <span class="dt">SCW =</span> <span class="kw">factor</span>(<span class="kw">ifelse</span>(Season <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;2009_2010&quot;</span>, <span class="st">&quot;2012_2013&quot;</span>, <span class="st">&quot;2014_2015&quot;</span>), <span class="st">&quot;Won&quot;</span>, <span class="st">&quot;Lost&quot;</span>))
         )

fjs &lt;-<span class="st"> </span><span class="kw">as.tibble</span>(columns) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">meas =</span> <span class="kw">colnames</span>(nhl_data)[<span class="op">-</span><span class="dv">1</span>])




<span class="kw">ggplot</span>(fis, <span class="kw">aes</span>(V2, V3, <span class="dt">color =</span> SCW)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_vline</span>(<span class="dt">xintercept =</span> <span class="dv">0</span>, <span class="dt">alpha =</span> <span class="dv">2</span><span class="op">/</span><span class="dv">3</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_hline</span>(<span class="dt">yintercept =</span> <span class="dv">0</span>, <span class="dt">alpha =</span> <span class="dv">2</span><span class="op">/</span><span class="dv">3</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">coord_cartesian</span>(<span class="dt">xlim =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">7</span>,<span class="dv">7</span>), <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">7</span>,<span class="dv">7</span>)) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_color_brewer</span>(<span class="dt">palette =</span> <span class="st">&quot;Dark2&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_text_repel</span>(<span class="kw">aes</span>(<span class="dt">label =</span> Season), <span class="dt">segment.alpha =</span> <span class="dv">0</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">theme_classic</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.title=</span><span class="kw">element_blank</span>(),
        <span class="co">#axis.text=element_blank(),</span>
        <span class="dt">axis.ticks=</span><span class="kw">element_blank</span>(),
        <span class="dt">axis.line =</span> <span class="kw">element_blank</span>()
        )

<span class="kw">ggplot</span>(fjs, <span class="kw">aes</span>(V2, V3)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_vline</span>(<span class="dt">xintercept =</span> <span class="dv">0</span>, <span class="dt">alpha =</span> <span class="dv">2</span><span class="op">/</span><span class="dv">3</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_hline</span>(<span class="dt">yintercept =</span> <span class="dv">0</span>, <span class="dt">alpha =</span> <span class="dv">2</span><span class="op">/</span><span class="dv">3</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">coord_cartesian</span>(<span class="dt">xlim =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">7</span>,<span class="dv">7</span>), <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">7</span>,<span class="dv">7</span>)) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_color_brewer</span>(<span class="dt">palette =</span> <span class="st">&quot;Dark2&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_text_repel</span>(<span class="kw">aes</span>(<span class="dt">label =</span> meas), <span class="dt">segment.alpha =</span> <span class="dv">0</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">theme_classic</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.title=</span><span class="kw">element_blank</span>(),
        <span class="co">#axis.text=element_blank(),</span>
        <span class="dt">axis.ticks=</span><span class="kw">element_blank</span>(),
        <span class="dt">axis.line =</span> <span class="kw">element_blank</span>()
        )

<span class="kw">ggplot</span>(nhl_data, <span class="kw">aes</span>(PEND, PENT)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>)

<span class="kw">cor.test</span>(nhl_data<span class="op">$</span>PENT, nhl_data<span class="op">$</span>PEND)
<span class="kw">summary</span>(<span class="kw">lm</span>(PENT<span class="op">~</span>PEND, <span class="dt">data =</span> nhl_data))</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">gp &lt;-<span class="st"> </span>nhl_data<span class="op">$</span>GP

nhl_data_mat_<span class="dv">2</span> &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(nhl_data[<span class="dv">3</span><span class="op">:</span><span class="kw">ncol</span>(nhl_data)])

nhl_data_scaled1 &lt;-<span class="st"> </span><span class="kw">apply</span>(nhl_data_mat_<span class="dv">2</span>[,<span class="dv">1</span><span class="op">:</span><span class="dv">7</span>], <span class="dv">2</span>, <span class="cf">function</span>(x){x<span class="op">/</span>gp})

nhl_ready &lt;-<span class="st"> </span><span class="kw">cbind</span>(nhl_data_scaled1, nhl_data_mat_<span class="dv">2</span>[,<span class="dv">8</span><span class="op">:</span><span class="dv">9</span>])

nhl_scaled &lt;-<span class="st"> </span><span class="kw">apply</span>(nhl_ready, <span class="dv">2</span>, scale)

nhl_svd &lt;-<span class="st"> </span><span class="kw">svd</span>(nhl_scaled)

rows &lt;-<span class="st"> </span>nhl_svd<span class="op">$</span>u <span class="op">%*%</span><span class="st"> </span><span class="kw">diag</span>(nhl_svd<span class="op">$</span>d)
columns &lt;-<span class="st"> </span>nhl_svd<span class="op">$</span>v <span class="op">%*%</span><span class="st"> </span><span class="kw">diag</span>(nhl_svd<span class="op">$</span>d)

fis &lt;-<span class="st"> </span><span class="kw">as.tibble</span>(rows) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">Season =</span> nhl_data<span class="op">$</span>Season,
         <span class="dt">SCW =</span> <span class="kw">factor</span>(<span class="kw">ifelse</span>(Season <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;2009_2010&quot;</span>, <span class="st">&quot;2012_2013&quot;</span>, <span class="st">&quot;2014_2015&quot;</span>), <span class="st">&quot;Won&quot;</span>, <span class="st">&quot;Lost&quot;</span>))
         )

fjs &lt;-<span class="st"> </span><span class="kw">as.tibble</span>(columns) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">meas =</span> <span class="kw">colnames</span>(nhl_data)[<span class="dv">3</span><span class="op">:</span><span class="kw">ncol</span>(nhl_data)])

inertia &lt;-<span class="st"> </span><span class="kw">sum</span>(nhl_svd<span class="op">$</span>d)

scree &lt;-<span class="st"> </span><span class="kw">tibble</span>(<span class="dt">eigs =</span> nhl_svd<span class="op">$</span>d, 
                <span class="dt">perc_explained =</span> (eigs<span class="op">/</span>inertia)<span class="op">*</span><span class="dv">100</span>,
                <span class="dt">comps =</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(eigs)
                )

<span class="kw">ggplot</span>(scree, <span class="kw">aes</span>(<span class="kw">factor</span>(comps), eigs)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_path</span>(<span class="kw">aes</span>(<span class="dt">group =</span> <span class="dv">1</span>)) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">sec.axis =</span> <span class="kw">sec_axis</span>(<span class="op">~</span>.<span class="op">/</span>inertia <span class="op">*</span><span class="st"> </span><span class="dv">100</span>, 
                                         <span class="dt">name =</span> <span class="st">&quot;Percentage of Explained Variance&quot;</span>
                                         )
                     ) <span class="op">+</span>
<span class="st">  </span><span class="kw">theme_minimal</span>()

<span class="kw">ggplot</span>(fis, <span class="kw">aes</span>(V1, V2, <span class="dt">color =</span> SCW)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_vline</span>(<span class="dt">xintercept =</span> <span class="dv">0</span>, <span class="dt">alpha =</span> <span class="dv">2</span><span class="op">/</span><span class="dv">3</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_hline</span>(<span class="dt">yintercept =</span> <span class="dv">0</span>, <span class="dt">alpha =</span> <span class="dv">2</span><span class="op">/</span><span class="dv">3</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">coord_cartesian</span>(<span class="dt">xlim =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">7</span>,<span class="dv">7</span>), <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">7</span>,<span class="dv">7</span>)) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_color_brewer</span>(<span class="dt">palette =</span> <span class="st">&quot;Dark2&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_text_repel</span>(<span class="kw">aes</span>(<span class="dt">label =</span> Season), <span class="dt">segment.alpha =</span> <span class="dv">0</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">theme_classic</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.title=</span><span class="kw">element_blank</span>(),
        <span class="co">#axis.text=element_blank(),</span>
        <span class="dt">axis.ticks=</span><span class="kw">element_blank</span>(),
        <span class="dt">axis.line =</span> <span class="kw">element_blank</span>()
        )

<span class="kw">ggplot</span>(fjs, <span class="kw">aes</span>(V1, V2)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_vline</span>(<span class="dt">xintercept =</span> <span class="dv">0</span>, <span class="dt">alpha =</span> <span class="dv">2</span><span class="op">/</span><span class="dv">3</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_hline</span>(<span class="dt">yintercept =</span> <span class="dv">0</span>, <span class="dt">alpha =</span> <span class="dv">2</span><span class="op">/</span><span class="dv">3</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">coord_cartesian</span>(<span class="dt">xlim =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">7</span>,<span class="dv">7</span>), <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">7</span>,<span class="dv">7</span>)) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_color_brewer</span>(<span class="dt">palette =</span> <span class="st">&quot;Dark2&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_text_repel</span>(<span class="kw">aes</span>(<span class="dt">label =</span> meas), <span class="dt">segment.alpha =</span> <span class="dv">0</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">theme_classic</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.title=</span><span class="kw">element_blank</span>(),
        <span class="co">#axis.text=element_blank(),</span>
        <span class="dt">axis.ticks=</span><span class="kw">element_blank</span>(),
        <span class="dt">axis.line =</span> <span class="kw">element_blank</span>()
        )</code></pre></div>
</div>
</div>

</div> <!-- articleBandContent -->
</div> <!-- pageContent -->
</div> <!-- forPagesWithTOC -->

<footer class="footer">
  <div class="container">
    <span class="text-muted">&copy; 2019 Matthew J. Kmiecik. All rights reserved.</span>
  </div>
</footer>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
